<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Window Server IT pro, love scripting.">
<meta property="og:type" content="website">
<meta property="og:title" content="Richie's Personal Blog">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Richie's Personal Blog">
<meta property="og:description" content="Window Server IT pro, love scripting.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Richie's Personal Blog">
<meta name="twitter:description" content="Window Server IT pro, love scripting.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/"/>





  <title> Richie's Personal Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Richie's Personal Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">Life is short, do something meaningful!</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/24/DHCP服务介绍及Linux下DHCP服务的管理配置/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/24/DHCP服务介绍及Linux下DHCP服务的管理配置/" itemprop="url">
                  DHCP服务介绍及Linux下DHCP服务的管理配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-24T16:42:41+08:00">
                2015-06-24
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1. DHCP服务简介  </p>
<p>DHCP是Dynamic Host Configuration<br>Protocol,动态主机配置协议，是用来在物理网络给主机分配ip地址的一种方式，区别于bootp，一次分配终身使用的缺点。</p>
<p>DHCP提出的租约的概念，使得可以根据需要动态确定主机需要的IP地址，并且IP地址可以循环使用。</p>
<p>2. DHCP结构</p>
<p>DHCP是典型的C/S结构，需要服务端启动守护进程来保证来自client段的请求能被响应，DHCP的工作原理如下：</p>
<p>可以通过DORA来记忆：</p>
<p>Client: DHCP DISCOVER #客户端向相同网络发送广播包，企图寻找DHCP服务器</p>
<p>Server: DHCP OFFER #如果DHCP服务段收到DISCOVER包，则向客户端回复OFFER广播包</p>
<p>Client: DHCP REQUEST</p>
<p>#客户端收到来自DHCP的OFFER广播包后，则确定DHCP服务器，继续向DHCP服务器发送REQUEST包，来申请ip信息</p>
<p>Server: DHCP ACK #DHCP服务端向客户端发送ACK包，携带ip和租约信息给客户端， DHCP发现过程结束</p>
<p>注意： dhcp在跨网段的路由器另一侧，则路由器需要开启dhcp<br>relay来支持转发客户端DISCOVER的广播包给DHCP服务器，这些通过路由器的转发，都是单播</p>
<p>因为路由器和dhcp之间的连接是有ip信息的。</p>
<p>DHCP服务端端口 UDP 67</p>
<p>DHCP客户端端口 UDP 68</p>
<p>DHCP reservation： 地址保留：</p>
<p>专用于某特定客户端的地址，不应该使用地址池中的地址；优先于地址池中的地址；</p>
<p>3. Linux下DHCP服务安装配置</p>
<p>由于CentOS6/7的系统管理机制不同，所以开机自启动服务的方式有所不同，但是配置文件，帮助文档大同小异</p>
<p>3.1 CentOS 6下 DHCP安装：</p>
<p>#yum install dhcp</p>
<p>#通过rpm -ql dhcp 来查询hdcp包所创建安装的文件，我们可以分析他的使用方式：</p>
<p>这里列举几个比较重要的文件：</p>
<p>#DHCP服务配置文件：</p>
<p>/etc/dhcp/dhcpd.conf</p>
<p>/etc/dhcp/dhcpd6.conf</p>
<p>#服务脚本，控制dhcp服务的启动，关闭，状态查询，reload等</p>
<p>/etc/rc.d/init.d/dhcpd</p>
<p>/etc/rc.d/init.d/dhcpd6</p>
<p>/etc/rc.d/init.d/dhcrelay</p>
<p>/etc/rc.d/init.d/dhcrelay6</p>
<p>#dhcp命令参数配置文件:<br>此文件内容提供一些区段给dhcpd守护进程在系统引导时使用，dhcpd守护进程使用DHCP及BOOTP协议为主机自动分配IP地址</p>
<p>/etc/sysconfig/dhcpd</p>
<p>/etc/sysconfig/dhcpd6</p>
<p>/etc/sysconfig/dhcrelay</p>
<p>/etc/sysconfig/dhcrelay6</p>
<p>#dhcp二进制程序</p>
<p>/usr/sbin/dhcpd</p>
<p>/usr/sbin/dhcrelay</p>
<p>#dhcp的ip地址租约库,可以查到ip分配情况</p>
<p>/var/lib/dhcpd/dhcpd.leases</p>
<p>/var/lib/dhcpd/dhcpd6.leases</p>
<p>4.1 CentOS6下dhcp服务配置文件管理：</p>
<p>4.1.1 首先编辑dhcp主配置文件：</p>
<p>/etc/dhcp/dhcpd.conf</p>
<p>option domain-name “richie.com”; #dhcp主机名</p>
<p>option domain-name-servers 192.168.229.141; #名称服务器的地址</p>
<p>default-lease-time 600; #默认租约秒数</p>
<p>max-lease-time 7200; #最大租约秒数</p>
<p>log-facility local7; #log级别</p>
<p>subnet 192.168.229.0 netmask 255.255.255.0 {</p>
<p>range 192.168.229.201 192.168.229.220; #可供分配的ip段</p>
<p>option routers 192.168.229.1, 192.168.229.2; #如果在最近配置的option<br>routers那就直接饮用，如果没有，那就会自动继承上一级的option</p>
<p>} #子网配置格式</p>
<p>当编辑完，保存退出，可以使用这个命令来检测语法错误：</p>
<p>service dhcpd configtest</p>
<p>4.1.2 配置ip地址预留:</p>
<p>需要在subnet {} 内部，配置host{}格式如下：</p>
<p>subnet 192.168.229.0 netmask 255.255.255.0 {</p>
<p>host windows1 {</p>
<p>hardware ethernet 00:0c:29:0:f3:44;</p>
<p>fixed-address 192.168.229.222;</p>
<p>option routers 192.168.0.1 #这里可以针对这台机器设置option routers的值，而不用继承上一级的网关信息</p>
<p>}</p>
<p>}</p>
<p>最后，保存退出</p>
<p>service dhcpd force-reload</p>
<p>测试效果：</p>
<p>linux client:</p>
<p>dhclient -d eth0</p>
<p>window client:</p>
<p>ipconfig /renew</p>
<p>4.1.3 配置开机自启动：</p>
<p>还是老命令chkconfig dhcpd on, 默认会将init级别2,3,4,5都设置为开机自启动， 也可以使用 chkconfig –level<br>2,3,4 来自己指定需要的运行级别自启</p>
<p>4.1.4 管理dhcp服务</p>
<p>service dhcpd {start|stop|restart|force-reload|condrestart|try-<br>restart|configtest|status}</p>
<p>4.2 CentOS 7下的DHCP服务管理</p>
<p>4.2.1 配置文件：</p>
<p>同CentOS6上的配置，参见4.1.1</p>
<p>4.2.2 配置ip地址预留:</p>
<p>同CentOS6上的配置，参见4.1.2</p>
<p>4.2.3 配置开机自启动：</p>
<p>由于CentOS6/7的系统服务管理机制的不同，CentOS7引入了systemd来管理所有的服务，所以不能再使用chkconfig命令来设置，需要使用：</p>
<h1 id="systemctl-is-enabled-DAEMON-service-查看dhcp服务状态，-相当于C5的-chkconfig-–list"><a href="#systemctl-is-enabled-DAEMON-service-查看dhcp服务状态，-相当于C5的-chkconfig-–list" class="headerlink" title="systemctl is-enabled DAEMON.service 查看dhcp服务状态， 相当于C5的 chkconfig –list"></a>systemctl is-enabled DAEMON.service 查看dhcp服务状态， 相当于C5的 chkconfig –list</h1><p>dhcpd</p>
<h1 id="systemctl-enable-DAEMON-service-启用开机自启动dhcp服务-相当于C5的-chkconfig-dhcpd-on"><a href="#systemctl-enable-DAEMON-service-启用开机自启动dhcp服务-相当于C5的-chkconfig-dhcpd-on" class="headerlink" title="systemctl enable DAEMON.service 启用开机自启动dhcp服务, 相当于C5的 chkconfig dhcpd on"></a>systemctl enable DAEMON.service 启用开机自启动dhcp服务, 相当于C5的 chkconfig dhcpd on</h1><h1 id="systemctl-disable-DAEMON-service-禁用开机自启动dhcp服务-相当于C5的-chkconfig-dhcpd-off"><a href="#systemctl-disable-DAEMON-service-禁用开机自启动dhcp服务-相当于C5的-chkconfig-dhcpd-off" class="headerlink" title="systemctl disable DAEMON.service 禁用开机自启动dhcp服务, 相当于C5的 chkconfig dhcpd off"></a>systemctl disable DAEMON.service 禁用开机自启动dhcp服务, 相当于C5的 chkconfig dhcpd off</h1><p>4.2.4 管理dhcp服务</p>
<h1 id="systemctl-start-stop-restart-status-DAEMON-service"><a href="#systemctl-start-stop-restart-status-DAEMON-service" class="headerlink" title="systemctl {start|stop|restart|status} DAEMON.service"></a>systemctl {start|stop|restart|status} DAEMON.service</h1><p>5. DHCP配置命令总结</p>
<p>一个简单dhcp服务的配置文件至少需要包含如下的配置信息：</p>
<p>dhcpd.conf</p>
<p>option domain-name</p>
<p>option domain-name-servers</p>
<p>option routers</p>
<p>subnet NETWORK netmask MASK {</p>
<p>range START_IP END_IP;</p>
<p>host HOSTID {</p>
<p>hardware ethernet 00:11:22:33:44:55;</p>
<p>fixed-address IP;</p>
<p>}</p>
<p>}</p>
<p>========================================================</p>
<p>例子：</p>
<p>dhcpd.conf</p>
<p>option domain-name “richie.com”;</p>
<p>option domain-name-servers 192.168.229.141;</p>
<p>default-lease-time 600;</p>
<p>max-lease-time 7200;</p>
<p>log-facility local7;</p>
<p>subnet 192.168.229.0 netmask 255.255.255.0 {</p>
<p>range 192.168.229.201 192.168.229.220;</p>
<p>option routers 192.168.229.1, 192.168.229.2;</p>
<p>host windows1 {</p>
<p>hardware ethernet 00:0c:29:30:f3:44;</p>
<p>fixed-address 192.168.229.211;</p>
<p>}</p>
<p>}</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/23/Xmanager无法弹出远程界面报错：Could not open display because no X server is running 解决办法/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/23/Xmanager无法弹出远程界面报错：Could not open display because no X server is running 解决办法/" itemprop="url">
                  Xmanager无法弹出远程界面报错：Could not open display because no X server is running 解决办法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-23T22:58:33+08:00">
                2015-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当你使用类似system-config-xxx命令的时候，希望弹出远程的linux界面时</p>
<p>就需要用到shell, 因为他自带一个Xmanager，可以实现这个功能。</p>
<p>但是当我安装完system-config-kickstart后，使用命令</p>
<p>#system-config-kickstart却报错</p>
<p>Could not open display because no X server is running</p>
<p>搜索了下，发现没有很好的解决办法，尝试了下export DISPLAY=客户端IP:0.0 这个方式，结果就可以了。。。。</p>
<p>如果有知道为啥的，希望有人能够回复下。着急赶学习进度，就暂且丢下这个问题，记录下结局方案。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/13/yum方式软件管理及进阶源码编译安装/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/13/yum方式软件管理及进阶源码编译安装/" itemprop="url">
                  yum方式软件管理及进阶源码编译安装
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-13T13:33:37+08:00">
                2015-06-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1. yum简介<br>2. yum组成结构<br>3. yum配置使用<br>4. yum命令详解<br>5. yum源变量<br>6. yum仓库创建<br>7.进阶源码编译安装</p>
<p>1. yum简介<br>YUM: Yellowdog Updater Modifed, 是由Duke University团队修改Yellow Dog Linux的Yellow<br>Dog<br>Updater开发而来的，是一个基于RPM包管理器的字符前端软件管理器(依赖于RPM包)。能够从指定的服务器自动下载RPM包并且安装，可以处理RPM包的依赖关系，并且一次安装所有依赖的软件包，无须繁琐的一次次下载、安装。被Fedora、Red<br>Hat Enterprise Linux、CentOS所使用。</p>
<p>2. yum的组成结构</p>
<p>简单的说： YUM就是一个RPM包管理工具，而且YUM是C/S结构，服务端就是一个文件服务器，都是rpm包；而YUM客户端可以配置多个YUM服务端来使用。</p>
<p>2.1 YUM服务端</p>
<p>yum repository: 称之为yum仓库，存在于yum服务器端，分成两部分：<br>a. 仓库数据：<br>各个数据包<br>b. 元数据(meta data)<br>数据文件信息在centos5是xml格式，在centos6,7上用的是sqlite，基于文件来实现关系型数据库<br>元数据包括：<br>包名，版本信息，各包所包含的文件列表，依赖关系，包分组信息<br>我们可以使用createrepo命令来给rpm包创建仓库</p>
<p>yum仓库 主要有以下几类：<br>base库 #基础库<br>update库 #更新版本库<br>extra库 #格外库<br>epel库 #fedora维护的库</p>
<p>#如果某软件base库里有，update库里也有，则应该使用update库中的包，因为update库中是更新的版本<br>以上库的优先顺序应为： base &gt; update &gt; extra &gt; epel</p>
<p>yum机制：<br>要想确保YUM正常工作，要满足以下几点：<br>2.1.1 确保有yum repo可用<br>rpm包的文件服务器中， repodta目录所在的父目录，就是一个可用仓库<br>例如：<a href="http://mirrors.sohu.com/centos/6/os/x86_64/" target="_blank" rel="external">http://mirrors.sohu.com/centos/6/os/x86_64/</a> 目录下有repodate目录的就可认定为一个yum仓库</p>
<p>yum仓库可以通过以下三种方式共享：</p>
<p>ftp: <a href="ftp://server/path/to/repository" target="_blank" rel="external">ftp://server/path/to/repository</a><br>http <a href="http://server/path/to/repository" target="_blank" rel="external">http://server/path/to/repository</a><br>nfs nfs://server/nfs_path<br>file file:///path/to/repository #本地文件系统，挂载光盘后直接就可以用 file:///media/cdrom 即可</p>
<p>3. yum配置使用</p>
<p>在客户端上必须要提供repo配置文件，指明仓库访问路径及各种属性信息</p>
<p>主配置文件(中心配置文件)： /etc/yum.conf (此配置文件的参数作用可以通过 man yum.conf查看)， 内容如下：</p>
<p>[main]<br>cachedir=/var/cache/yum/$basearch/$releasever #缓存目录<br>keepcache=0 #是否保存缓存数据？ 0 不保存<br>debuglevel=2 #debug信息等级<br>logfile=/var/log/yum.log #yum的日志信息保存地址<br>exactarch=1 #exact arch match? 是否要精确匹配平台？<br>obsoletes=1 #是否要检查过期仓库？<br>gpgcheck=1<br>plugins=1<br>installonly_limit=5<br>bugtracker_url=<a href="http://bugs.centos.org/set_project.php?project_id=19&amp;ref=http://bugs.centos.org/bug_report_page.php?category=yum" target="_blank" rel="external">http://bugs.centos.org/set_project.php?project_id=19&amp;ref;=http://bugs.centos.org/bug_report_page.php?category=yum</a><br>distroverpkg=centos-release</p>
<h1 id="This-is-the-default-if-you-make-this-bigger-yum-won’t-see-if-the-metadata"><a href="#This-is-the-default-if-you-make-this-bigger-yum-won’t-see-if-the-metadata" class="headerlink" title="This is the default, if you make this bigger yum won’t see if the metadata"></a>This is the default, if you make this bigger yum won’t see if the metadata</h1><h1 id="is-newer-on-the-remote-and-so-you’ll-“gain”-the-bandwidth-of-not-having-to"><a href="#is-newer-on-the-remote-and-so-you’ll-“gain”-the-bandwidth-of-not-having-to" class="headerlink" title="is newer on the remote and so you’ll “gain” the bandwidth of not having to"></a>is newer on the remote and so you’ll “gain” the bandwidth of not having to</h1><h1 id="download-the-new-metadata-and-“pay”-for-it-by-yum-not-having-correct"><a href="#download-the-new-metadata-and-“pay”-for-it-by-yum-not-having-correct" class="headerlink" title="download the new metadata and “pay” for it by yum not having correct"></a>download the new metadata and “pay” for it by yum not having correct</h1><h1 id="information"><a href="#information" class="headerlink" title="information."></a>information.</h1><h1 id="It-is-esp-important-to-have-correct-metadata-for-distributions-like"><a href="#It-is-esp-important-to-have-correct-metadata-for-distributions-like" class="headerlink" title="It is esp. important, to have correct metadata, for distributions like"></a>It is esp. important, to have correct metadata, for distributions like</h1><h1 id="Fedora-which-don’t-keep-old-packages-around-If-you-don’t-like-this-checking"><a href="#Fedora-which-don’t-keep-old-packages-around-If-you-don’t-like-this-checking" class="headerlink" title="Fedora which don’t keep old packages around. If you don’t like this checking"></a>Fedora which don’t keep old packages around. If you don’t like this checking</h1><h1 id="interupting-your-command-line-usage-it’s-much-better-to-have-something"><a href="#interupting-your-command-line-usage-it’s-much-better-to-have-something" class="headerlink" title="interupting your command line usage, it’s much better to have something"></a>interupting your command line usage, it’s much better to have something</h1><h1 id="manually-check-the-metadata-once-an-hour-yum-updatesd-will-do-this"><a href="#manually-check-the-metadata-once-an-hour-yum-updatesd-will-do-this" class="headerlink" title="manually check the metadata once an hour (yum-updatesd will do this)."></a>manually check the metadata once an hour (yum-updatesd will do this).</h1><h1 id="metadata-expire-90m"><a href="#metadata-expire-90m" class="headerlink" title="metadata_expire=90m"></a>metadata_expire=90m</h1><h1 id="PUT-YOUR-REPOS-HERE-OR-IN-separate-files-named-file-repo"><a href="#PUT-YOUR-REPOS-HERE-OR-IN-separate-files-named-file-repo" class="headerlink" title="PUT YOUR REPOS HERE OR IN separate files named file.repo"></a>PUT YOUR REPOS HERE OR IN separate files named file.repo</h1><h1 id="in-etc-yum-repos-d"><a href="#in-etc-yum-repos-d" class="headerlink" title="in /etc/yum.repos.d"></a>in /etc/yum.repos.d</h1><p>一个或多个相关仓库的配置信息可保存在一个文件，文件名都以.repo结尾，存放在/etc/yum.repos.d 目录下</p>
<p>在.repo文件定义一个yum repo指向的格式：</p>
<p>[REPOID] #这个REPOID可以自己设定任意字符<br>name=Some name for this repository #此行等号两侧不能有空格，右侧可以加空格，不写此字段使用yum会报warning<br>baseurl=file:///media/cdrom #baseurl可以有多个，用来指定真正仓库的所在地<br>ftp: <a href="ftp://server/path/to/repository" target="_blank" rel="external">ftp://server/path/to/repository</a><br>http <a href="http://server/path/to/repository" target="_blank" rel="external">http://server/path/to/repository</a><br>nfs nfs://server/nfs_path  </p>
<p>#多个baseurl 必须按照上面格式书写，第二个baserul不能出现在行首<br>enabled={0,1} #1为启用此repo<br>gpgcheck={0,1} #是否检查GPG(GNU Private Guard)，一种密钥方式签名。<br>gpgkey=URL #当配置gpgcheck选项时，要加上gpgkey来验证<br>例如：gpgkey=file:///media/cdrom/GPG-RPM-KEY-centos-6<br>mirrorlist=URL to a file #这个文件指向多个baseurl，不定义baseurl的时候可以用这个指定多个仓库<br>cost={1..n} #默认值为1000， 指定访问此仓库的开销</p>
<p>例如在yum客户端创建一个新的repo，首先定位到/etc/yum.repos.d下创建一个文件 163.repo<br>内容如下：</p>
<p>[163]<br>name=CentOS 6 from 163 mirror<br>baseurl=<a href="http://mirrors.163.com/centos/6.6/os/x86_64/" target="_blank" rel="external">http://mirrors.163.com/centos/6.6/os/x86_64/</a> #记得检查该目录是否有 repodata目录<br>enabled=1<br>gpgcheck=0</p>
<p>然后可以使用命令 yum repolist 查看到此repo配置</p>
<p>4. yum命令详解</p>
<p>这里的yum命令都是指在客户端上使用的，包括列表，清理缓存，安装/重新安装/降级安装/卸载，查询等命令。</p>
<p>4.1 列出所有可用repo<br>yum repolist {enabled|disabled|all} #列出{已经启用的|已禁用的|所有的}可用的repo</p>
<p>4.2 列出rpm包<br>yum list {all|installed|available} # 列出{所有|已安装|未安装但repo内有的}</p>
<p>4.3 查看包的描述信息<br>yum info package_name</p>
<p>4.4 列出所有的包组信息<br>yum grouplist</p>
<p>4.5 显示包组的信息， 指定某个包组的程序包列表和功能<br>yum groupinfo “GROUP NAME”<br>例如： yum groupinfo “Server Platform Development”</p>
<p>4.6 清理缓存<br>yum clean {all|packages|metadata|expire-cache|rpmdb|plugins}</p>
<p>#清理{所有|特定rpm包|元数据|过期缓存|repo数据库|插件}的缓存</p>
<p>只有yum clean all比较常用，其他用的到的在来翻看笔记吧</p>
<p>#注，清理缓存并不会删除目录结构，只是结构内的数据被清除<br>可以用 tree /var/cache/yum来对比 清理缓存后的文件列表对比</p>
<p>4.7 安装程序包<br>yum install package_name</p>
<p>重新安装程序包<br>yum reinstall package_name</p>
<p>4.8 升级程序<br>检查可用的升级包<br>yum check-update #并不会执行安装<br>升级包<br>yum update package_name<br>例如： 我们要升级一个程序 x-1.3.1<br>当前repo中存在x-1.3.2, x-1.3.3, x-2.0.1 三个版本，我们只想安装特定的x-1.3.2<br>而直接运行 yum update x ，会直接将x升级到最新版本 x-2.0.1<br>这时候，我们可以加上rpm包的版本，指定升级版本</p>
<p>升级到特定版本<br>yum update package_name-version</p>
<p>降级包<br>yum downgrade package_name</p>
<p>4.9 卸载包<br>yum remove|erase package_name  </p>
<p>#如果卸载一个软件被其他软件依赖， 那会连同所用的依赖包一同卸载掉。</p>
<p>4.10 查询某配置文件是由哪个包生成的？<br>yum whatprovides | provides /path/to/somefile  </p>
<p>#whatprovides和provides两个参数都可以</p>
<p>4.11 安装包组<br>yum groupinstall “GROUP NAME” #可以用yum gourplist来查看都支持哪些包组</p>
<p>4.12 卸载包组<br>yum groupremove “GROUP NAME”</p>
<p>4.1.3 安装仓库外rpm包</p>
<p>假设： 从其他处获得一个rpm包， 如果此包依赖于其他包(在仓库中)， 如何安装？<br>如果只是单次安装需要：<br>CentOS 5:<br>yum install /path/to/package_file</p>
<p>CentOS 6,7:<br>yum localinstall /path/to/package_fiel</p>
<p>5. yum源变量</p>
<p>在使用在线的repo源的时候， 客户端yum配置文件中中可以使用4个变量</p>
<p>$releasever： 程序的版本 #可以根据系统来替换成相应的主版本号，5,6,7，而主版本号下的连接是当前发行版的最新版本5.6,6.5,7.1等<br>$arch: 系统架构<br>$basearch: 系统基本架构，如i686, i586等的基本架构为i386<br>$uuid:<br>$YUM0-9： 在系统中定义的环境变量， 可以在yum中使用：</p>
<p>ps:<br>实际环境中，baseurl中常用$releasever和$basearch来替换本地架构和linux版本来让仓库的配置文件更具有通用性，让不同的平台版本可以使用同一个配置文件。</p>
<p>5.1 获取yum源变量值</p>
<p>获取当前系统相应变量替换结果的办法：<br>-bash-4.1# python<br>Python 2.6.6 (r266:84292, Jan 22 2014, 09:42:36)<br>[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2  </p>
<blockquote>
<blockquote>
<blockquote>
<p>import yum,pprint<br>yb = yum.YumBase()<br>pprint.pprint(yb.conf.yumvar,width=1)<br>Loaded plugins: fastestmirror, refresh-packagekit<br>{‘arch’: ‘ia32e’,<br>‘basearch’: ‘x86_64’,<br>‘infra’: ‘stock’,<br>‘releasever’: ‘6’,<br>‘uuid’: ‘54298ec4-d059-4bfe-a967-cce66eb95513’}<br>quit()</p>
</blockquote>
</blockquote>
</blockquote>
<p>6. yum仓库创建</p>
<p>yum仓库可以分为本地仓库和在线仓库两种：</p>
<p>6.1 自建本地yum仓库：<br>1. 如何自建基于光盘镜像的yum repo<br>挂载光盘<br>mount /dev/cdrom /media/cdrom<br>在/etc/yum.repo.d/下创建一个.repo文件<br>内容为：<br>[base]<br>name=Local Media<br>baseurl=file:///media/cdrom<br>pgpcheck=0<br>enabled=1</p>
<p>2. 自简提供yum仓库的中心服务器<br>ftp, http, nfs 三种常用的文件服务器</p>
<p>以http为例：，步骤：<br>1. 安装httpd程序  </p>
<p>#rpm -ivh http-x-x-x-x.rpm<br>1.2 启动httpd服务  </p>
<p>#service httpd start  </p>
<p>#chkconfig httpd on #centos7 不适用</p>
<p>2. httpd的文档根目录为/var/www/html<br>创建子目录，存放某相关的所有rpm包</p>
<p>3. 为仓库生成元数据文件，以使其能够作为仓库使用<br>3.1 安装 craeterepo<br>rpm -ivh createrepo-xxx.xxx.xxx.rpm<br>或者  </p>
<p>#yum install createrepo</p>
<p>3.2 对rpm包目录createrepo：  </p>
<p>#createrepo /var/www/html/zabbix  </p>
<h1 id="createrepo-var-www-html-zabbix"><a href="#createrepo-var-www-html-zabbix" class="headerlink" title="createrepo /var/www/html/zabbix"></a>createrepo /var/www/html/zabbix</h1><p>Spawning worker 0 with 16 pkgs<br>Workers Finished<br>Gathering worker results</p>
<p>Saving Primary metadata<br>Saving file lists metadata<br>Saving other metadata<br>Generating sqlite DBs<br>Sqlite DBs complete  </p>
<p>则该目录下会自动生成一个repodata目录，该目录/var/www/html/zabbix就可以当repo用了</p>
<p>4. 配置yum客户端<br>[zabbix]<br>name=zabbix repo<br>baseurl=<a href="http://192.168.229.141" target="_blank" rel="external">http://192.168.229.141</a><br>gpgcheck=0<br>enabled=1</p>
<p>然后就可以使用这个repo了</p>
<p>7.进阶源码编译安装</p>
<p>7.1 编译安装，依赖于开发环境<br>程序源码：<br>c/c++ 底层，无跨平台能力<br>perl<br>python</p>
<p>别人制作好的rpm包，都是编译过的，而当源码包的功能有20个，<br>主包：6个功能<br>分包1: 2个功能<br>分包2： 4个功能</p>
<p>也就是说别人会根据需求订制功能，编译后rpm包功能会比源码功能少，并且也会比源码包慢几个版本<br>可能出现你需要的功能，在别人编译好的rpm上没办法使用，这时候就需要我们自己来根据源代码来自己编译安装</p>
<p>开源的源代码有如下两个方式来提供：</p>
<p>1.开源应用程序：<br>自建站点： #一般都是比较大型的项目会有自己的站点<br>apache, ASF<br>mysql<br>drbd<br>2. 代码托管： #一些中小型项目的源代码一般都使用代码托管的方式，寄存在以下的代码托管网站<br>Sourceforge<br>github.com<br>code.google.com</p>
<p>tips： 编译安装的缺点是： 无法自动卸载安装的文件，所以习惯把编译安装的软件放在一个目录下，便于日后升级卸载</p>
<p>7.2 编译工具：gcc<br>gnu c complier 只能用来编译c程序<br>gcc-c++ 用来编译c++程序<br>使用 rpm -qa| grep gcc 可以看到本机有很多种针对不同语言的编译工具，编译是很耗时的</p>
<p>7.3 源代码的组织格式：<br>多文件：<br>文件中的代码有依赖关系<br>项目管理工具：<br>GNU make(gcc) 定义好多文件之间的编译关系，处理多文件内源码的依赖关系</p>
<p>项目: 50文件<br>项目的制作者： 利用make工具，为make提供一个配置文件<br>make不是编译工具，是编译的管理工具</p>
<p>autoconf: 生成编译环境检查(检查开发环境是否满足编译需求)及编译功能配置(选择源码内的功能)脚本<br>生成configure<br>当configure脚本执行的时候，会结合automake工具生成的Makefile.in来生成makefile</p>
<p>automake： 生成一个Makefile.in –&gt; makefile</p>
<p>7.4 编译源程序的步骤：  </p>
<h1 id="tar-xf-testapp-version-tar-xz-bz-gz"><a href="#tar-xf-testapp-version-tar-xz-bz-gz" class="headerlink" title="tar xf testapp-version.tar.{xz|bz|gz}"></a>tar xf testapp-version.tar.{xz|bz|gz}</h1><h1 id="cd-testapp-version"><a href="#cd-testapp-version" class="headerlink" title="cd testapp-version"></a>cd testapp-version</h1><h1 id="configure"><a href="#configure" class="headerlink" title="./configure"></a>./configure</h1><p>还需要通过许多选项指定编译特性，选取功能  </p>
<h1 id="make"><a href="#make" class="headerlink" title="make"></a>make</h1><h1 id="make-install"><a href="#make-install" class="headerlink" title="make install"></a>make install</h1><p>./configure 脚本的使用：<br>1. 获取帮助<br>./configure –help #基于每个项目内的配置选项是不同的，需要查看</p>
<p>2. 通用一些选项<br>安装路径相关：<br>--prefix=/path/to/somewhere: 指定安装路径<br>--sysconfdir=/path/to/somewhere: 指定配置文件安装路径的， 路径应该为/etc/下某个目录</p>
<p>指定启用/禁用的特性<br>--enable-FEATURE 例如 –enable-fpm ,但是启用一个功能，就会依赖另外的开发环境包<br>--disable-FEATURE 例如 –disable-socket</p>
<p>指定所依赖的功能、程序或文件<br>--with-FUNCTION[=/path/to/somewhere]<br>--without-FUNCTION</p>
<p>7.5 安装后的配置：</p>
<p>7.5.1 程序运行及维护：</p>
<p>1. 让二进制程序直接运行，而无需输入路径  </p>
<p>#vim /etc/profile.d/APPNAME.sh<br>export PATH=$PATH:/path/to/somewhere</p>
<p>2. 导出手册页：<br>编辑/etc/man.config 配置文件，添加一项MANPATH，路径为新安装的程序的man目录<br>或者  </p>
<p>#man -M /path/to/somewhere KEYWORD 就可以找KEYWORD的帮助手册了</p>
<p>3. 自己编写/etc/init.d/的启动脚本</p>
<p>ps: 如果只是为了编译安装，并运行软件，则到此就可以结束了。  </p>
<h1 id="下面的步骤是为了解决其他应用程序依赖开发环境，和针对编译安装程序的二次开发准备环境使用的。"><a href="#下面的步骤是为了解决其他应用程序依赖开发环境，和针对编译安装程序的二次开发准备环境使用的。" class="headerlink" title="下面的步骤是为了解决其他应用程序依赖开发环境，和针对编译安装程序的二次开发准备环境使用的。  "></a>下面的步骤是为了解决其他应用程序依赖开发环境，和针对编译安装程序的二次开发准备环境使用的。  </h1><p>7.5.2 程序开发： 如果其他应用程序依赖此程序的开发环境，或针对此程序做二次开发<br>1. 导出库文件<br>第一步： 指定让系统搜索定制的路径<br>编辑/etc/ld.so.conf.d/APPNAME.conf<br>一行一个库文件路径</p>
<p>例如： vim /etc/ld.so.conf.d/nginx.conf  </p>
<p>#/usr/local/ngxin/lib  </p>
<p>第二步：触发系统重新搜索所有的库文件并生成缓存  </p>
<p>#ldconfig<br>-v 显示过程</p>
<p>2. 导出头文件<br>/usr/local/ngxin/include</p>
<p>系统找头文件的路径是 /usr/include</p>
<p>导出方式： 创建链接进行<br>ln -sv /usr/local/ngxin/include /usr/include/nginx</p>
<p>启动程序得自己写，在/etc/init.d/，不是不能启动，自己写好，就可以和其他软件用同一种风格来运行了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/12/RPM包管理/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/12/RPM包管理/" itemprop="url">
                  RPM包管理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-12T00:02:00+08:00">
                2015-06-12
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>目录：<br>1. RPM简介<br>2. RPM包获取方式<br>3. RPM包安装<br>4. RPM包卸载<br>5. RPM包升级<br>6. RPM包查询<br>7. RPM包校验<br>8. RPM数据库重建</p>
<p>1.简介：</p>
<p>RPM软件包管理器， RPM (原Red Hat Package Manager)，现在被很多Linux发行版使用，现在就叫 RPM Package<br>Manager<br>是一种二进制包管理器，可以完成软件安装、卸载、升级、查询、校验等操作。</p>
<p>2. RPM包获取方式</p>
<p>获取rpm包的途径：</p>
<p>众所周知，网上鱼龙混杂，随意下载到的rpm包可能会被人恶意篡改，而对系统安全产生威胁，我们需要找到一些靠谱的方式来找到权威的rpm包提供者，下面三种方式比较靠谱：</p>
<p>2.1 发行的光盘或站点服务器：</p>
<p>镜像：<br><a href="http://mirrors.163.com" target="_blank" rel="external">http://mirrors.163.com</a><br><a href="http://mirrors.sohu.com" target="_blank" rel="external">http://mirrors.sohu.com</a><br><a href="http://mirrors.aliyun.com" target="_blank" rel="external">http://mirrors.aliyun.com</a><br>…<br>很多高校也建立了开源镜像站点，可以供我们使用。</p>
<p>2.2 项目的官网</p>
<p>例如：<a href="http://www.zsh.org/" target="_blank" rel="external">http://www.zsh.org/</a><br>从官网可以看到源代码，并且可以下载到rpm包</p>
<p>2.3 很多第三方机构或个人制作并公开发布许多rpm包,例如：</p>
<p><a href="http://rpmfind.net" target="_blank" rel="external">http://rpmfind.net</a></p>
<p><a href="http://rpm.pbone.net" target="_blank" rel="external">http://rpm.pbone.net</a></p>
<p>一个可靠的途径： EPEL(Extra Packages for Enterprise Linux)</p>
<p>是由Fedora community来维护的，这里不详细叙述使用EPEL<br>使用文档可以参见： <a href="http://fedoraproject.org/wiki/EPEL" target="_blank" rel="external">http://fedoraproject.org/wiki/EPEL</a></p>
<p>3. RPM包安装</p>
<p>当我们拿到来源可靠的RPM包后，接下来就是安装RPM包了，RPM的安装依靠rpm命令完成，语法如下：</p>
<p>rpm [option] /path/to/package_file #这里要指定RPM包的路径  </p>
<p>3.1 -i: install，安装rpm包<br>当我们仅用 rpm -i 来安装某包时候，比如我们安装zsh包<br>前提： 我们使用光盘作为rpm包源 先用：<br>mount /dev/cdrom /media/cdrom #将光盘挂载到/media/cdrom下<br>ls /media/cdrom #看下光盘目录结构：</p>
<p>-r–r–r–. 2 root root 14 Nov 29 2013 CentOS_BuildTag<br>dr-xr-xr-x. 3 root root 2048 Nov 29 2013 EFI<br>-r–r–r–. 2 root root 212 Nov 27 2013 EULA<br>-r–r–r–. 2 root root 18009 Nov 27 2013 GPL<br>dr-xr-xr-x. 3 root root 2048 Nov 29 2013 images<br>dr-xr-xr-x. 2 root root 2048 Nov 29 2013 isolinux<br>dr-xr-xr-x. 2 root root 655360 Nov 29 2013 Packages<br>-r–r–r–. 2 root root 1354 Nov 27 2013 RELEASE-NOTES-en-US.html<br>dr-xr-xr-x. 2 root root 4096 Nov 29 2013 repodata<br>-r–r–r–. 2 root root 1706 Nov 27 2013 RPM-GPG-KEY-CentOS-6<br>-r–r–r–. 2 root root 1730 Nov 27 2013 RPM-GPG-KEY-CentOS-Debug-6<br>-r–r–r–. 2 root root 1730 Nov 27 2013 RPM-GPG-KEY-CentOS-Security-6<br>-r–r–r–. 2 root root 1734 Nov 27 2013 RPM-GPG-KEY-CentOS-Testing-6<br>-r–r–r–. 1 root root 3380 Nov 29 2013 TRANS.TBL</p>
<p>其中有一个目录为Packages，<br>这个目录下包含了所有的rpm包，我们来测试安装位于/media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm</p>
<p>rpm -i /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm<br>你会发现什么都没提示就完成了，如果在运行一次就会提示你已经安装了  </p>
<h1 id="rpm-i-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-i-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -i /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -i /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm</h1><p>package zsh-4.3.10-7.el6.x86_64 is already installed</p>
<p>3.2 -v： 显示安装信息， -v需要结合-i来使用，如-iv，测试安装zsh：</p>
<h1 id="rpm-iv-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-iv-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -iv /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -iv /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm</h1><p>Preparing packages for installation…<br>zsh-4.3.10-7.el6<br>这次安装会提示你准备信息，和安装的名称。</p>
<p>3.3 -vv: 显示更详细的安装信息<br>详细到每一个文件的创建过程，以及改变记录，输出更多的debug信息</p>
<h1 id="rpm-ivv-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-ivv-media-cdrom-Packages-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -ivv /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ivv /media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm</h1><p>你会看到很多debug信息。</p>
<p>3.4 -h: hash，显示软件解压缩过程，例如：</p>
<h1 id="rpm-ih-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-ih-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -ih zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ih zsh-4.3.10-7.el6.x86_64.rpm</h1><p>########################################### [100%]  </p>
<p>########################################### [100%]</p>
<p>会显示解压缩过程</p>
<p>3.5 组合安装选项 -ivh<br>我们用的最多的还是rpm -ivh 这种组合选项，能够显示出足够多信息，例如：</p>
<h1 id="rpm-ivh-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-ivh-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -ivh zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ivh zsh-4.3.10-7.el6.x86_64.rpm</h1><p>Preparing… ########################################### [100%]<br>1:zsh ########################################### [100%]</p>
<p>3.6 –test:<br>仅测试安装，并不真正执行安装，如果我们运行一个没有对其他包有依赖的rpm包，如下：</p>
<h1 id="rpm-ivh-–test-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-ivh-–test-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -ivh –test zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ivh –test zsh-4.3.10-7.el6.x86_64.rpm</h1><p>Preparing… ########################################### [100%]</p>
<p>只会显示准备安装，但是没有真正的安装，如果有依赖关系，则会报错，给我们一种方式来测试依赖关系：</p>
<p>3.6 解决安装依赖问题<br>关于安装过程中，如果我们安装B包，但是B包依赖于A包，我们安装的时候就会出现问题，如果我们用上面的安装命令来安装php：</p>
<h1 id="rpm-ivh-php-5-3-3-26-el6-x86-64-rpm"><a href="#rpm-ivh-php-5-3-3-26-el6-x86-64-rpm" class="headerlink" title="rpm -ivh php-5.3.3-26.el6.x86_64.rpm"></a>rpm -ivh php-5.3.3-26.el6.x86_64.rpm</h1><p>error: Failed dependencies:<br>php-cli(x86-64) = 5.3.3-26.el6 is needed by php-5.3.3-26.el6.x86_64<br>php-common(x86-64) = 5.3.3-26.el6 is needed by php-5.3.3-26.el6.x86_64</p>
<p>就会出现我们安装php，但是php依赖php-cli和php-common两个包，安装失败。</p>
<p>所以，解决安装包依赖问题有两种解决办法：<br>1. 解决依赖关系<br>按照依赖关系提示，我们把依赖包一一装好<br>2. 忽略依赖关系<br>忽略依赖关系，会强制安装指定包，但是软件很有可能无法正常运行，不推荐使用<br>--nodeps<br>例如忽略php的依赖包php-cli和php-common，强行安装php：</p>
<h1 id="rpm-ivh-–nodeps-php-5-3-3-26-el6-x86-64-rpm"><a href="#rpm-ivh-–nodeps-php-5-3-3-26-el6-x86-64-rpm" class="headerlink" title="rpm -ivh –nodeps php-5.3.3-26.el6.x86_64.rpm"></a>rpm -ivh –nodeps php-5.3.3-26.el6.x86_64.rpm</h1><p>Preparing… ########################################### [100%]<br>package php-5.4.41-47.el6.art.x86_64 (which is newer than<br>php-5.3.3-26.el6.x86_64) is already installed<br>file /etc/httpd/conf.d/php.conf from install of php-5.3.3-26.el6.x86_64<br>conflicts with file from package php-5.4.41-47.el6.art.x86_64<br>file /usr/lib64/httpd/modules/libphp5.so from install of<br>php-5.3.3-26.el6.x86_64 conflicts with file from package<br>php-5.4.41-47.el6.art.x86_64  </p>
<h1 id=""><a href="#" class="headerlink" title=" "></a> </h1><p>虽然安装上了php包，但是php服务并不能正常使用。</p>
<p>3.7 –replacepkgs 重新安装<br>替换上一次原有安装，如果原有的配置文件做了修改，很有可能不执行替换，而是将安装应该安装生成的配置文件重命名为 .rpmnew</p>
<p>例如，我们安装zsh，然后修改zsh生成的文件，然后使用–replacepkgs来重新安装，来测试我们修改的文件是否被重命名</p>
<p>首先，安装zsh  </p>
<h1 id="rpm-ivh-zsh-4-3-10-7-el6-x86-64-rpm-1"><a href="#rpm-ivh-zsh-4-3-10-7-el6-x86-64-rpm-1" class="headerlink" title="rpm -ivh zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ivh zsh-4.3.10-7.el6.x86_64.rpm</h1><p>Preparing… ########################################### [100%]<br>1:zsh ########################################### [100%]  </p>
<h1 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h1><p>查找安装zsh时生成的配置文档  </p>
<h1 id="rpm-qc-zsh"><a href="#rpm-qc-zsh" class="headerlink" title="rpm -qc zsh"></a>rpm -qc zsh</h1><p>/etc/skel/.zshrc<br>/etc/zlogin<br>/etc/zlogout<br>/etc/zprofile<br>/etc/zshenv<br>/etc/zshrc</p>
<p>我们修改下/etc/zprofile，在尾行添加一个注释信息  </p>
<h1 id="echo-“-This-is-comments”-gt-gt-etc-zprofile"><a href="#echo-“-This-is-comments”-gt-gt-etc-zprofile" class="headerlink" title="echo “# This is comments” &gt;&gt; /etc/zprofile"></a>echo “# This is comments” &gt;&gt; /etc/zprofile</h1><p>然后使用 –replacepkgs重新安装zsh  </p>
<h1 id="rpm-ivh-–replacepkgs-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-ivh-–replacepkgs-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -ivh –replacepkgs zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -ivh –replacepkgs zsh-4.3.10-7.el6.x86_64.rpm</h1><p>tail -1 /etc/zprofile #查看/etc/zprofile最后一行，我们上次更改的信息并没有被删除</p>
<p>4. 卸载程序包：<br>rpm [option] package_name #使用包名，而不是带版本号的那个文件名<br>-e: erase<br>如果被其他包依赖：<br>1. 将依赖于此包的所有包一并卸载<br>2. 忽略依赖关系 –nodeps<br>能卸载，但是依赖于此包的程序包可能会运行不正常</p>
<p>4.1 批量卸载</p>
<p>rpm -qa | grep “keyword” | xargs rpm -e  </p>
<p>eg: warning: /etc/zprofile saved as /etc/zprofile.rpmsave</p>
<p>举例： 我们来删除zsh包  </p>
<h1 id="rpm-e-zsh"><a href="#rpm-e-zsh" class="headerlink" title="rpm -e zsh"></a>rpm -e zsh</h1><p>warning: /etc/zprofile saved as /etc/zprofile.rpmsave</p>
<p>注意，删除zsh时候我们得到一个warning，提示我们/etc/zprofile文件修改过，被转存到/etc/zprofile.rpmsave<br>!!! 如果包的配置文件安装后曾被改动过，卸载时，此文件不会卸载，而是被重命名并保留</p>
<p>5. RPM包升级<br>新版本替换老版本<br>rpm [option] /path/to/package_file<br>1. 升级或安装<br>-Uvh<br>2. 纯升级<br>-Fvh</p>
<p>升级后可能会带来版本冲突，<br>--force 可以强制升级</p>
<p>注意： 不应该对内核执行升级操作，而是安装<br>系统允许多内核并存</p>
<p>6. RPM包查询<br>6.1 查询某包是否安装<br>rpm -q package_name … 可一次查询多个</p>
<p>例如：查询是否安装了cpp, python, bind  </p>
<h1 id="rpm-q-cpp-python-bind"><a href="#rpm-q-cpp-python-bind" class="headerlink" title="rpm -q cpp python bind"></a>rpm -q cpp python bind</h1><p>cpp-4.4.7-11.el6.x86_64<br>python-2.6.6-52.el6.x86_64<br>package bind is not installed</p>
<p>6.2 查询所有已经安装的包<br>rpm -qa<br>按条件过滤： rpm -qa | grep ‘PATTERN’</p>
<p>例如： 查询以python开头的包都有哪些？  </p>
<h1 id="rpm-qa-grep-‘-python’"><a href="#rpm-qa-grep-‘-python’" class="headerlink" title="rpm -qa | grep ‘^python’"></a>rpm -qa | grep ‘^python’</h1><p>python-ethtool-0.6-5.el6.x86_64<br>python-decorator-3.0.1-3.1.el6.noarch<br>python-iwlib-0.1-1.2.el6.x86_64<br>python-markupsafe-0.9.2-4.el6.x86_64<br>python-beaker-1.3.1-7.el6.noarch<br>python-pycurl-7.19.0-8.el6.x86_64<br>python-meh-0.12.1-3.el6.noarch<br>python-iniparse-0.3.1-2.1.el6.noarch<br>python-mako-0.3.4-1.el6.noarch<br>python-urlgrabber-3.9.1-9.el6.noarch<br>python-libs-2.6.6-52.el6.x86_64<br>python-2.6.6-52.el6.x86_64<br>python-slip-0.2.20-1.el6_2.noarch<br>python-slip-dbus-0.2.20-1.el6_2.noarch</p>
<p>6.3 查询包的描述信息<br>rpm -qi package_name #只能查询已经安装包的信息</p>
<p>例如： 查询zsh包的详细信息  </p>
<h1 id="rpm-qi-zsh"><a href="#rpm-qi-zsh" class="headerlink" title="rpm -qi zsh"></a>rpm -qi zsh</h1><p>Name : zsh Relocations: (not relocatable)<br>Version : 4.3.10 Vendor: CentOS<br>Release : 7.el6 Build Date: Sun 24 Nov 2013 09:40:59 AM PST<br>Install Date: Thu 11 Jun 2015 08:26:36 AM PDT Build Host:<br>c6b9.bsys.dev.centos.org<br>Group : System Environment/Shells Source RPM: zsh-4.3.10-7.el6.src.rpm<br>Size : 5009102 License: BSD<br>Signature : RSA/SHA1, Sun 24 Nov 2013 11:33:46 AM PST, Key ID 0946fca2c105b9de<br>Packager : CentOS BuildSystem <a href="&lt;http://bugs.centos.org">&lt;http://bugs.centos.org</a>&gt;<br>URL : <a href="http://zsh.sunsite.dk/" target="_blank" rel="external">http://zsh.sunsite.dk/</a><br>Summary : A powerful interactive shell<br>Description :<br>The zsh shell is a command interpreter usable as an interactive login<br>shell and as a shell script command processor. Zsh resembles the ksh<br>shell (the Korn shell), but includes many enhancements. Zsh supports<br>command line editing, built-in spelling correction, programmable<br>command completion, shell functions (with autoloading), a history<br>mechanism, and more.</p>
<p>简单解释下Relications意义为是否支持指定安装路径，Group为包组名</p>
<p>6.4 查询某包安装生成了哪些文件<br>rpm -ql package_name #会列出该包生成的所有文档，包括配置文件、帮助文档  </p>
<p>4.1 查询某包安装生成了哪些配置文件(通常都是存放在/etc/下的文件)<br>rpm -qc package_name<br>4.2 查询某包安装生成了哪些帮助文件<br>rpm -qd package_name<br>4.3 查询程序包的相关脚本<br>rpm -q –scripts package_name</p>
<p>脚本有4类：<br>preinstall: 安装前要执行的脚本<br>postinstall: 安装完成后要执行的脚本<br>preuninstall: 卸载前要执行的脚本<br>postuninstall： 卸载后要执行的脚本</p>
<p>例如： 查询zsh包都安装了哪些配置文档?  </p>
<h1 id="rpm-qc-zsh-1"><a href="#rpm-qc-zsh-1" class="headerlink" title="rpm -qc zsh"></a>rpm -qc zsh</h1><p>/etc/skel/.zshrc<br>/etc/zlogin<br>/etc/zlogout<br>/etc/zprofile<br>/etc/zshenv<br>/etc/zshrc</p>
<p>查询zsh包都安装了哪些帮助文档?  </p>
<h1 id="rpm-qd-zsh"><a href="#rpm-qd-zsh" class="headerlink" title="rpm -qd zsh"></a>rpm -qd zsh</h1><p>/usr/share/doc/zsh-4.3.10/BUGS<br>/usr/share/doc/zsh-4.3.10/CONTRIBUTORS<br>/usr/share/doc/zsh-4.3.10/FAQ<br>/usr/share/doc/zsh-4.3.10/FEATURES<br>/usr/share/doc/zsh-4.3.10/LICENCE<br>/usr/share/doc/zsh-4.3.10/MACHINES<br>/usr/share/doc/zsh-4.3.10/NEWS<br>/usr/share/doc/zsh-4.3.10/README<br>/usr/share/doc/zsh-4.3.10/completion-style-guide<br>/usr/share/doc/zsh-4.3.10/zsh-development-guide<br>/usr/share/doc/zsh-4.3.10/zshprompt.pl<br>/usr/share/info/zsh.info-1.gz<br>…<br>6.5 查询某文件是由那个包安装生成的<br>rpm -qf /path/to/conf_file #指定某个配置文档</p>
<p>比如说/etc/fstab，我们想知道它是哪个包生成的，我们可以这么写：  </p>
<h1 id="rpm-qf-etc-fstab"><a href="#rpm-qf-etc-fstab" class="headerlink" title="rpm -qf /etc/fstab"></a>rpm -qf /etc/fstab</h1><p>setup-2.8.14-20.el6_4.1.noarch</p>
<p>就可以知道/etc/fstab文件，是通过setup-2.8.14-20.el6_4.1.noarch 来生成的了。但是这仅针对于已经安装的包可用。<br>对没安装的包进行查询就需要下面的方法。</p>
<p>6.6 对尚未安装的包执行查询 -p<br>rpm [option] /path/to/package_file #必须指定包的位置及包的全名<br>例如:/media/cdrom/Packages/zsh-4.3.10-7.el6.x86_64.rpm<br>-qpi 描述信息<br>-qpl 会生成了哪些文件<br>-qpc 会生成哪些配置文件<br>-qpd 会生成哪些帮助文件</p>
<p>例如：我们想查询php包的描述信息</p>
<h1 id="rpm-qpi-php-5-3-3-26-el6-x86-64-rpm"><a href="#rpm-qpi-php-5-3-3-26-el6-x86-64-rpm" class="headerlink" title="rpm -qpi php-5.3.3-26.el6.x86_64.rpm"></a>rpm -qpi php-5.3.3-26.el6.x86_64.rpm</h1><p>Name : php Relocations: (not relocatable)<br>Version : 5.3.3 Vendor: CentOS<br>Release : 26.el6 Build Date: Fri 22 Nov 2013 03:07:55 AM PST<br>Install Date: (not installed) Build Host: c6b9.bsys.dev.centos.org<br>Group : Development/Languages Source RPM: php-5.3.3-26.el6.src.rpm<br>Size : 3700269 License: PHP<br>Signature : RSA/SHA1, Sun 24 Nov 2013 11:33:09 AM PST, Key ID 0946fca2c105b9de<br>Packager : CentOS BuildSystem <a href="&lt;http://bugs.centos.org">&lt;http://bugs.centos.org</a>&gt;<br>URL : <a href="http://www.php.net/" target="_blank" rel="external">http://www.php.net/</a><br>Summary : PHP scripting language for creating dynamic web sites<br>Description :<br>PHP is an HTML-embedded scripting language. PHP attempts to make it<br>easy for developers to write dynamically generated webpages. PHP also<br>offers built-in database integration for several commercial and<br>non-commercial database management systems, so writing a<br>database-enabled webpage with PHP is fairly simple. The most common<br>use of PHP coding is probably as a replacement for CGI scripts.</p>
<p>The php package contains the module which adds support for the PHP<br>language to Apache HTTP Server.</p>
<p>查询生成了哪些文件？<br>rpm -qpl php-5.3.3-26.el6.x86_64.rpm<br>查询生成了哪些配置文件？<br>rpm -qpc php-5.3.3-26.el6.x86_64.rpm<br>查询生成了哪些帮助文件？<br>rpm -qpd php-5.3.3-26.el6.x86_64.rpm</p>
<p>总之，查询已安装包的特定信息使用的是 rpm -q{i,l,d} ，对未安装的包查询信息，就多了一个p， 为rpm -qp{i,l,d}</p>
<p>===================================================================================</p>
<p>7. RPM包校验</p>
<p>RPM包的合法性验证分两部分：<br>1. 来源合法性<br>2. 包的完整性</p>
<p>包的制作者使用单项加密提取原始数据的特征码，而后使用自己的私钥加密这段特征码，附加原始数据后面<br>验证过程：<br>前提：必须有可靠机制获取到包制作者的公钥<br>1、使用制作者的公钥解密 加密的特征码， 能解密则意味来源合法<br>2、使用与制作者同样的单向加密算法提取原始数据的特征码，并与解密出来的特征码做比对， 相同，则意味着完整性没问题</p>
<p>7.1 校验： 检查包后文件属性是否发生变化<br>rpm -V package_name #用的不多</p>
<p>如检查光盘中zsh包：  </p>
<h1 id="rpm-V-zsh"><a href="#rpm-V-zsh" class="headerlink" title="rpm -V zsh"></a>rpm -V zsh</h1><p>S.5….T. c /etc/zprofile</p>
<p>返回给我们一个 S.5….T. c /etc/zprofile, 具体含义如下：</p>
<p>S file Size differs<br>M Mode differs (includes permissions and file type)<br>5 digest (formerly MD5 sum) differs<br>D Device major/minor number mismatch<br>L readLink(2) path mismatch<br>U User ownership differs<br>G Group ownership differs<br>T mTime differs<br>P caPabilities differ</p>
<p>某属性没变化的位，显示为 .</p>
<p>7.2 rpm包来源合法性及完整性检验：<br>前提： 在当前系统上导入包的制作者的公钥<br>导入公钥：<br>rpm –import /path/to/key_file<br>光盘上的公钥就在根目录下面：<br>-r–r–r–. 2 root root 1706 Nov 27 2013 RPM-GPG-KEY-CentOS-6<br>-r–r–r–. 2 root root 1730 Nov 27 2013 RPM-GPG-KEY-CentOS-Debug-6<br>-r–r–r–. 2 root root 1730 Nov 27 2013 RPM-GPG-KEY-CentOS-Security-6<br>-r–r–r–. 2 root root 1734 Nov 27 2013 RPM-GPG-KEY-CentOS-Testing-6</p>
<p>查看已导入公钥：<br>rpm -qa gpg-pubkey*</p>
<h1 id="rpm-qa-gpg-pubkey"><a href="#rpm-qa-gpg-pubkey" class="headerlink" title="rpm -qa gpg-pubkey*"></a>rpm -qa gpg-pubkey*</h1><p>gpg-pubkey-5ebd2744-418ffac9<br>gpg-pubkey-c105b9de-4e0fd3a3<br>gpg-pubkey-4520afa9-50ab914c</p>
<p>查看单条pubkey的详细内容<br>rpm -qi gpg-pubkey-NAME</p>
<p>比如我查看第一个公钥信息：  </p>
<h1 id="rpm-qi-gpg-pubkey-5ebd2744-418ffac9"><a href="#rpm-qi-gpg-pubkey-5ebd2744-418ffac9" class="headerlink" title="rpm -qi gpg-pubkey-5ebd2744-418ffac9"></a>rpm -qi gpg-pubkey-5ebd2744-418ffac9</h1><p>Name : gpg-pubkey Relocations: (not relocatable)<br>Version : 5ebd2744 Vendor: (none)<br>Release : 418ffac9 Build Date: Fri 22 May 2015 09:58:23 AM PDT<br>Install Date: Fri 22 May 2015 09:58:23 AM PDT Build Host: localhost<br>Group : Public Keys Source RPM: (none)<br>Size : 0 License: pubkey<br>Signature : (none)<br>Summary : gpg(Atomic Rocket Turtle )<br>Description :<br>-—-BEGIN PGP PUBLIC KEY BLOCK—–<br>Version: rpm-4.8.0 (NSS-3)</p>
<p>mQGiBEGP+skRBACyZz7muj2OgWc9FxK+Hj7tWPnrfxEN+0PE+n8MtqH+dxwQpMTd<br>gDpOXxJa45GM5pEwB6CFSFK7Fb/faniF9fDbm1Ga7MpBupIBYLactkoOTZMuTlGB<br>T0O5ha4h26YLqFfQOtlEi7d0+BDDdfHRQw3o67ycgRnLgYSA79DISc3MywCgk2TR<br>yd5sRfZAG23b4EDl+D0+oaMEAK73J7zuxf6F6V5EaxLd/w4JVB2xW0Glcn0fACOe<br>8FV9lzcZuo2xPpdGuyj02f/xlqvEav3XqTfFU2no61mA2pamaRNhlo+CEfGc7qde<br>/1twfSgOYqzeCx7+aybyPo8Th41b80FT19mfkjBf6+5NbUHffRabFFh1FmcPVNBn<br>F3FoA/95nRIzqDMItdTRitaZn02dIGNjdwllBD75bSVEvaR9O5hjBo0VMc25DB7f<br>DM2qEO52wCQbAKw9zFC284ekZVDaK4aHYt7iobHaqJEpKHgsDut5WWuMiSLR+SsF<br>aBHIZ9HvrKWLSUQKHU6A1Hva0P0r3GnoCMc/VCVfrLl721SjPbQzQXRvbWljIFJv<br>Y2tldCBUdXJ0bGUgPGFkbWluQGF0b21pY3JvY2tldHR1cnRsZS5jb20+iFkEExEC<br>ABkFAkGP+skECwcDAgMVAgMDFgIBAh4BAheAAAoJEDKpURRevSdEzcQAn1hSHqTO<br>jwv/z/picpOnR+mgycwHAKCBex2ciyXo5xeaQ9w7OMf7Jsmon7kBDQRBj/rMEAQA<br>6JvRndqE4koK0e49fUkICm1X0ZEzsVg9VmUW+Zft5guCRxmGlYTmtlC7oJCToRP/<br>m/xH5uIevGiJycRKB0Ix+Csl6f9QuTkQ7tSTHcaIKbI3tL1x6CCBoWeTGYaOJlvk<br>ubrmajiMFaBfopLH2firoSToDGoUvv4e7bImIHEgNr8AAwUEAND0YR9DOEZvc+Lq<br>Ta/PQyxkdZ75o+Ty/O64E3OmO1Tuw2ciSQXCcwrbrMSE6EHHetxtGCnOdkjjjtmH<br>AnxsxdONv/EJuQmLcoNcsigZZ4tfRdmtXgcbnOmXBgmy1ea1KvWcsmecNSAMJHwR<br>7vDDKzbj4mSmudzjapHeeOewFF10iEYEGBECAAYFAkGP+swACgkQMqlRFF69J0Sq<br>nQCfa/q9Y/oY4dOTGj6MsdmRIQkKZhYAoIscjinFwTru4FVi2MIEzUUMToDK<br>=NOIx<br>-—-END PGP PUBLIC KEY BLOCK—–</p>
<p>检查包： 安装过程中会自动进行</p>
<p>手动检查：</p>
<p>rpm -K /path/to/package_file<br>rpm –checksig /path/to/package_file<br>不检查包完整性(只检查来源合法性)：<br>rpm -K –nodigest<br>不检查来源合法性(只检查包完整性)<br>rpm -K –nosignature</p>
<p>例如: 手动检查zsh包的包完整性及来源合法性  </p>
<h1 id="rpm-K-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-K-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -K zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -K zsh-4.3.10-7.el6.x86_64.rpm</h1><p>zsh-4.3.10-7.el6.x86_64.rpm: rsa sha1 (md5) pgp md5 OK</p>
<p>仅检查zsh包的包完整性：  </p>
<h1 id="rpm-K-–nosignature-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-K-–nosignature-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -K –nosignature zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -K –nosignature zsh-4.3.10-7.el6.x86_64.rpm</h1><p>zsh-4.3.10-7.el6.x86_64.rpm: sha1 md5 OK</p>
<p>仅检查zsh包的来源合法性：  </p>
<h1 id="rpm-K-–nodigest-zsh-4-3-10-7-el6-x86-64-rpm"><a href="#rpm-K-–nodigest-zsh-4-3-10-7-el6-x86-64-rpm" class="headerlink" title="rpm -K –nodigest zsh-4.3.10-7.el6.x86_64.rpm"></a>rpm -K –nodigest zsh-4.3.10-7.el6.x86_64.rpm</h1><p>zsh-4.3.10-7.el6.x86_64.rpm: rsa (md5) pgp OK</p>
<p>======================================================================================================</p>
<p>8. 数据库重建：<br>RPM的安装，卸载，查询升级，校验等操作都需要RPM的数据库数据正确，如果数据库出错，则无法操作RPM</p>
<p>数据库目录位于: /var/lib/rpm</p>
<p>重建有两种方式：  </p>
<p>8.1. rpm –initdb : 初始化<br>如果事先没有库，会新建一个库； 如果有库，则不会新建</p>
<p>8.2 rpm –rebuilddb ： 重建<br>直接重建，覆盖原有的数据库</p>
<p>两种方式重建RPM数据库都不会有提示，直接显示完成</p>
<p>总结，RPM包管理器是很重要的知识点，整理笔记成此博客，锻炼下自己梳理内容的能力，也方便日后查看，如果有理解不正确的地方，欢迎大家多多指教！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/09/Linux网络属性配置总结/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/09/Linux网络属性配置总结/" itemprop="url">
                  Linux网络属性配置总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-09T22:01:04+08:00">
                2015-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>要理解OSI 7层模型：  </p>
<p>首先要了解IP Header 和TCP Header， 上图</p>
<p>tcp三次握手：</p>
<p>1次： SYN=1， ACK=0， FIN=0</p>
<p>2次： SYN=1， ACK=1， FIN=0</p>
<p>3次： SYN=0， ACK=1， FIN=0</p>
<p>Linux网络属性配置：</p>
<p>IP/NETMASK(网络掩码) #想完成本地网络通信，必须要配置ip地址和网络掩码</p>
<p>路由： #想要联通两个或两个以上不同网络，必须要配置路由信息，又称作NEXT_HOP(下一跳)</p>
<p>主机路由</p>
<p>网络路由</p>
<p>默认网关</p>
<p>DNS服务器：</p>
<p>主DNS服务器</p>
<p>备用DNS服务器 #只有主DNS服务器不通时，才会使用备用DNS，不管主服务器解析结果如何也不会找备用DNS</p>
<p>配置网络属性：</p>
<p>静态配置</p>
<p>动态配置： DHCP( Dynamic Host Configuration Protocal)</p>
<p>配置IP：</p>
<p>用户空间工具：</p>
<p>ifconfig(net-tools) #比较古老的工具，最小化系统也会自动安装， 但最新的CentOS7最小化安装不会安装此工具</p>
<p>ip(iproute2) #比较新的工具，CentOS7自带</p>
<p>网络设备服务配置文件： /etc/sysconfig/network-scripts/</p>
<p>主机名： /etc/resolv.conf</p>
<p>网络设备的配置方式：</p>
<p>内核识别硬件设备 –》 驱动</p>
<p>设备名称：</p>
<p>以太网： ethX 例如 第一块以太网网卡设备会被系统识别成 eth0</p>
<p>ppp网络： pppX</p>
<p>lopback： 本地回环, lo</p>
<p>ifconfig #默认为显示所有处于激活状态的连接</p>
<p>-a 显示所有连接信息，包括处于未激活状态的设备信息</p>
<p>ifconfig IFNAME: 仅显示指定接口的信息， 例如： ifconfig eth0</p>
<p>ifconfig IFNAME ADDRESS # 添加指定ip信息 !!这种配置方法，会立即生效， 但是不会永久有效!!</p>
<p>ip/mask</p>
<p>长格式： ifconfig IFNAME IP netmask MASK</p>
<p>eg： ifconfig eth0 192.168.1.100 netmask 255.255.255.0</p>
<p>短格式： ifconfig IFNAME IP/MASK</p>
<p>eg: ifconfig eth0 192.168.1.100/24</p>
<p>route #古老的路由信息修改工具 !!这种配置方法，会立即生效， 但是不会永久有效!!</p>
<p>route 显示路由信息</p>
<p>-n 数字格式的地址， 不解析名称，速度会很快;</p>
<p>route add</p>
<p>-host 目标为主机</p>
<p>-host HOST IP gw NEXT_HOP [dev DEVICE]</p>
<p>eg: route add -host 192.168.1.100 gw 192.168.1.1 #意为：<br>添加一条ip为192.168.1。100的主机路由，网关为192.168.1.1</p>
<p>-net 目标是网络</p>
<p>-net NET_ADDRESS gw NEXT_HOP [dev DEVICE]</p>
<p>eg: route add 172.16.0.0 gw 192.168.1.1 #意为：<br>添加一条网络路由，目标地址为172.16.0.0网络，网关为192.168.1.1</p>
<p>-net 0.0.0.0 表示目标为任意地址 等于以下写法：</p>
<p>-net default</p>
<p>eg: route add -net default gw 192.168.1.1</p>
<p>route del</p>
<p>-host HOST_IP</p>
<p>-net NET_ADDRESS</p>
<p>DNS服务器地址 #无法通过命令添加dns</p>
<p>本地解析： /etc/hosts</p>
<p>此文件中，可以以空格指定多个name</p>
<p>DNS服务器解析：指定DNS服务器地址 /etc/resolv.conf</p>
<p>此文件中，只能放3个nameserver,次序很重要</p>
<p>dig工具：</p>
<p>dig -t A FQDN www.xom</p>
<p>dig -x IP 反向解析</p>
<p>使用命令配置的信息直接送往内核 (TCP/IP协议栈) 并立即生效</p>
<p>IP/NETMASK：</p>
<p>配置文件有两类(/etc/sysconfig/network-scripts)：</p>
<p>1. 配置IP、掩码、网关：</p>
<p>以太网： ifcfg-IFNAME</p>
<p>PPP:  ifcfg-pppX</p>
<p>2. 配置路由：</p>
<p>route-IFNAME</p>
<p>CentOS 5:</p>
<p>/etc/rc.d/init.d/network</p>
<p>CentOS 6:</p>
<p>/etc/rc.d/init.d/network</p>
<p>/etc/rc.d/init.d/NetworkManager #不支持桥接网络</p>
<p>/etc/rc.d/init.d/ , /etc/init.d/*</p>
<p>sysV风格的脚本： 多数脚本都用于控制Linux的后台进程，接受参数{start|stop|restart|status}</p>
<h1 id="etc-init-d-network-start"><a href="#etc-init-d-network-start" class="headerlink" title="/etc/init.d/network start"></a>/etc/init.d/network start</h1><h1 id="service-network-start"><a href="#service-network-start" class="headerlink" title="service network start"></a>service network start</h1><p>以上两种调用效果一致，但是在CentOS 7上不再支持</p>
<p>配置某服务开机是/否自动运行：</p>
<h1 id="chkconfig-SRVNAME-on"><a href="#chkconfig-SRVNAME-on" class="headerlink" title="chkconfig SRVNAME on"></a>chkconfig SRVNAME on</h1><h1 id="chkconfig-SRVNAME-off"><a href="#chkconfig-SRVNAME-off" class="headerlink" title="chkconfig SRVNAME off"></a>chkconfig SRVNAME off</h1><p>命令重启后生效</p>
<p>查看那些哪些服务开机自动运行</p>
<h1 id="chkconfig-–list"><a href="#chkconfig-–list" class="headerlink" title="chkconfig –list"></a>chkconfig –list</h1><p>ifcfg-IFNAM 配置文件的格式：</p>
<p>DEVICE=IFNAME #此配置文件所关联到的设备，设备名称要与本文件名ifcfg-后面保持一致</p>
<p>BOOTPROTO={bootp|dhcp|static|none}</p>
<p>HWADDR= 00:11:22:33:44 #当前设备的MAC地址； 此行可有可无，但是写的是错的，就会报错</p>
<p>NM_CONTROLLED={yes|no} # 是否接受NetworkManager服务脚本来配置此设备； 建议设置为no</p>
<p>ONBOOT={yes|no} #是否在开机过程中，自动激活此接口</p>
<p>TYPE={Ethernet|Bridge} #网络接口类型</p>
<p>UUID=</p>
<p>IPADDR= #如果BOOTPROTO给定了dhcp，这里给定ip也不会配置</p>
<p>NETMASK=</p>
<p>GATEWAY= #默认网关</p>
<p>DNS1=</p>
<p>DNS2=</p>
<p>DNS3=</p>
<p>IPV6INIT={yes|no} #启动IPv6</p>
<p>USERCTL={yes|no} #是否接受普通用户控制此接口</p>
<p>PEERDNS={yes|no} #<br>是否接受DHCP服务器指派的DNS服务器地址，如果接受，则系统会修改/etc/resolv.conf内的nameserver信息</p>
<p>route-IFNAME: #路由信息，重启后仍然存在</p>
<p>配置文件的格式有两种：</p>
<p>1. 每行一个路由条目</p>
<p>DESTINATION via NEXT_HOP</p>
<p>eg:</p>
<p>10.0.0.0 via 172.16.0.1</p>
<p>2. 每三行一个路由条目</p>
<p>ADDRESS#=DESTINATION</p>
<p>NETMASK#=MASK</p>
<p>GATEWAWY#=GW</p>
<p>eg:</p>
<p>ADRESS0=10.0.0.0</p>
<p>NETMASK0=255.0.0.0</p>
<p>GATEWAY0=172.16.0.1</p>
<p>ADDRESS1=2.2.0.0</p>
<p>NETMASK1=255.255.0.0</p>
<p>GATEWAY1=172.16.0.1</p>
<p>如何配置主机名：</p>
<p>hostname</p>
<p>hostname HOSTNAME #立即生效，但是不会永久有效</p>
<p>配置文件： /etc/sysconfig/network</p>
<p>NETWORKING=yes #是否联网</p>
<p>HOSTNAME=主机名</p>
<p>#重启后，永久生效</p>
<p>如何在一个网络接口配置多个IP地址</p>
<p>通过网络接口的别名来实现：</p>
<p>ens33, ens33:0. ens33:1, ens33:2…</p>
<p>eth0, eth0:0, eth0:1, eth0:2…</p>
<p>IFNAME:#</p>
<p>1.命令配置： 立即生效,重启服务后失效</p>
<p>ifconfig IFALIAS IP</p>
<p>eg: ifconfig eth0:0 192.168.1.2</p>
<p>2.配置文件： 别名不支持使用DHCP进行配置</p>
<p>/etc/sysconfig/network-scripts/ifcfg-IFALIAS</p>
<p>DEVICE=IFALIAS # eg: DEVICE:eth0:0</p>
<p>BOOTPROTO={static|none}</p>
<p>IPADDR=</p>
<p>NETWASK=</p>
<p>GATEWAY= #一个主机只能有一个网关，可以指定或者不指定</p>
<p>ONBOOT=</p>
<p>USERCTL=</p>
<p>3. TUI or GUI:</p>
<p>TUI: system-config-network-tui #也可以用setup命令，CENTOS 7上不支持</p>
<p>GUI: system-config-network-gui</p>
<p>修改的结果会保存至相应的网络接口的配置文件ifcfg-IFNAME, 因此，不会立即生效</p>
<p>网络管理相关工具：</p>
<p>ping: ICMP</p>
<p>-c #: 报文的个数</p>
<p>-W #： 等待响应报文的超时时长</p>
<p>traceroute: #获取从当前主机到达目标主机所经由的所有网关</p>
<p>traceroute HOST</p>
<p>mtr： mtr combines the functionality of the traceroute and ping programs in a<br>single network diagnostic tool.</p>
<p>netstat: (ss) 网络状态</p>
<p>-t: tcp协议相关</p>
<p>-u：udp协议相关</p>
<p>-n: 将FQDN和Service Name显示为数字格式，否则将使用解析，很耗时</p>
<p>名称解析：</p>
<p>FQDN &lt;--&gt; IP</p>
<p>Service Name &lt;--&gt; 端口</p>
<p>-l: listen，显示处于监听状态的连接</p>
<p>-a: 所有状态的连接</p>
<p>-tan</p>
<p>-p: 显示会话中的进程程序名及进程号</p>
<p>-r: routing, 显示路由表 &lt;==&gt; route -n</p>
<p>-rn 常用组合</p>
<p>显示网络接口设备的属性信息：</p>
<p>ethtool:</p>
<p>-S 显示设备接口的统计数据</p>
<p>eg： ethtool -S eth0</p>
<p>======================================</p>
<p>课外任务： nmap, ncat, tcpdump,</p>
<p>======================================</p>
<p>ip命令：</p>
<p>ip link 管理接口</p>
<p>show [IFNAME] 不显示ip信息，只显示接口信息</p>
<p>set IFNAME {up|down}</p>
<p>&lt;==&gt; ifconfig IFNAME {up|down}</p>
<p>&lt;==&gt; ifup IFNAME</p>
<p>&lt;==&gt; ifdown IFNAME</p>
<p>set IFNAME multicast {on|off} #启动多播</p>
<p>ip addr： 管理协议地址</p>
<p>ip addr {show|flush} [dev DEVICE]</p>
<p>eg: ip addr show dev eth0</p>
<p>ip addr{add|del} ADDRESS dev DEVICE [label IFALIAS] [broadcast BCAST_ADDRESS]</p>
<p>eg: ip addr add/del 192.168.229.144/24 dev eth0 #这种添加方法无须添加设备别名，用ifconfig看不到</p>
<p>eg：ip addr add/del 192.168.229.154/24 dev eth0 label eth0:0 #这种添加有别名</p>
<p>#ifconfig IFNAME ADDRESS broadcast BCAST_ADDRESS</p>
<p>ip route: 管理路由</p>
<p>ip route list</p>
<p>ip route flush</p>
<p>ip route add DESTINATION [via NEXT_HOP] [src SOURCE_ADDRESS] [dev DEVICE]</p>
<p>ip route del DESTINATION</p>
<p>ss命令：</p>
<p>ss：</p>
<p>-t tcp</p>
<p>-u udp</p>
<p>-p 进程相关的process</p>
<p>-l listening</p>
<p>-n numeric</p>
<p>-a all</p>
<p>-e 扩展信息</p>
<p>-m 套接字相关的内存使用信息</p>
<p>-o state {established|listening|fin_wait_1|fin_wait_2|}</p>
<p>‘(dport = )’ 或者 ‘(sport = )’</p>
<p>只显示指定状态的连接，还可以指定过滤条件</p>
<p>练习： 写一个脚本</p>
<p>扫描172.16.250.0/16内的所有主机： 在线的，使用绿色显示： 不在线的使用红色显示</p>
<p>说明： 在线，不在线各有多少台主机</p>
<p>=======================================================================================</p>
<p>#!/bin/bash</p>
<p>#</p>
<p>declare -i deadsum=0</p>
<p>declare -i alivesum=0</p>
<p>for ((i=0;i&lt;=255;i++));do</p>
<p>for ((j=1;j&lt;=254;j++));do</p>
<p>if [ <code>ping -c 1 -W 1 192.168.$i.$j &amp;&gt; /dev/null</code> ];then</p>
<p>echo -e “\033[32m 192.168.$i.$j \033[0m” &gt;&gt; /tmp/alive.txt</p>
<p>let alivesum++</p>
<p>else</p>
<p>echo -e “\033[31m 192.168.$i.$j \033[0m” &gt;&gt; /tmp/dead.txt</p>
<p>let deadsum++</p>
<p>fi</p>
<p>done</p>
<p>done</p>
<p>echo “There are $alivesum server online, and $deadsum servers offline” &gt;&gt;<br>/tmp/results.txt</p>
<p>练习： 写一个脚本</p>
<p>1. 提示用户输入一个IP地址： 如果用户输入的地址不正确，则提醒其重新输入直到正确为止：</p>
<p>2. 如果正确，则添加至eth0上的辅助地址：</p>
<p>（考虑掩码问题，</p>
<p>第一段0-128 掩码就是255.0.0.0</p>
<p>第一段128-191 255.255.0.0</p>
<p>第一段191-223 255.255.255.0</p>
<p>）</p>
<p>命令总结： ifconfig, ifup, ifdown, route, netstat, ping traceroute, mtr, ethtool,<br>setup, dig, ip, ss</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/09/使用Powershell来创建自签名证书/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/09/使用Powershell来创建自签名证书/" itemprop="url">
                  使用Powershell来创建自签名证书
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-09T17:26:02+08:00">
                2015-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先要确认PowerShell的版本，如果版本低于4.0， 那需要下载MakeCert.exe或者使用其他工具创建自签名整数。</p>
<p>所以这里默认你服务器版本为 windows server 2012/R2, 使用是没问题IDE</p>
<p>这里会用到两个命令：</p>
<pre><code>New-SelfSignedCertificate  #创建自签名证书
Export-PfxCertificate    #导出pfx格式证书
</code></pre><ol>
<li>创建自签证书  </li>
</ol>
<p>New-SelfSignedCertificate -CertStoreLocation cert:\localmachine\my -DnsName<br>FQDN.yourdomain.com</p>
<p>运行后，会返回一个Thumbprint</p>
<ol>
<li>创建加密密码</li>
</ol>
<ol>
<li>导出pfx证书</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/06/Linux压缩和解压缩工具/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/06/Linux压缩和解压缩工具/" itemprop="url">
                  Linux压缩和解压缩工具
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-06T16:28:38+08:00">
                2015-06-06
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>压缩： 根据一定算法</p>
<p>文本文件</p>
<p>compress/uncompress, .Z  </p>
<p>gzip/gunzip (只能压缩文件，不能压缩目录)  </p>
<p>.gz</p>
<p>-#: 压缩比，默认为6， 范围为0-9：</p>
<p>-d: 解压缩，等于gunzip</p>
<p>-c: 将压缩后的结果输出至标准输出，</p>
<p>gzip -c /path/to/somefile &gt; /path/to/somecfile.gz</p>
<p>zcat somefile.gz: 不解压查看gzip压缩后的文件</p>
<p>bzip2/bunzip2</p>
<p>.bz2</p>
<p>-#：压缩比，默认为6 范围0-9</p>
<p>-d: 解压缩，bunzip2</p>
<p>-k：保留原文件</p>
<p>bzcat somefile.bz2 : 不解压，查看bzip2压缩后的文件</p>
<p>xz/unxz</p>
<p>.xz</p>
<p>-#: 压缩比，默认为6 范围0-9</p>
<p>-d: 解压缩，等于unxz</p>
<p>-k: 保留原文件</p>
<p>xzcat somefile.xz: 不解压，查看xz压缩后文件</p>
<p>ps： gzip/bzip2/xz 都不支持目录压缩</p>
<p>zip/unzip</p>
<p>zip ZIPFILE.zip src_file : 原文件可以是多个</p>
<p>zip ZIPFILE.zip src_folder/*</p>
<p>upzip ZIPFILE.zip</p>
<p>归档工具：</p>
<p>1. tar</p>
<p>能实现将多个文件打包成单个文件，即为归档文件</p>
<p>tar [option] … -f tarfile.tar src_file…</p>
<p>创建归档：</p>
<p>tar</p>
<p>-c: create</p>
<p>-f: FILE.tar 指定归档后的文件，文件名必须出现在-f后， 例如可以-cf FILE.tar，但是不可以写成 -fc FILE.tar</p>
<p>-v: verbose</p>
<p>展开归档：</p>
<p>tar</p>
<p>-x: extract</p>
<p>-v: verbose</p>
<p>-f FILE.tar</p>
<p>查看归档后的文件中，包含了哪些原文件：</p>
<p>tar</p>
<p>-t: 查看归档文件，事实没解压下查看</p>
<p>-f：</p>
<p>tar可直接通过选项调用压缩工具执行压缩或解压缩：</p>
<p>tar</p>
<p>-z: 调用gzip</p>
<p>-j：调用bzip2</p>
<p>-J: 调用xz</p>
<p>-xf： 可以自动判断文件压缩类型，并调用相应工具来解压缩文件，而不需制定z/j/J</p>
<p>-tf: 不解压，查看压缩文档内文件</p>
<p>2. cpio：</p>
<p>用的不是特别多，只是在特定环境下才用的到</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/Linux LVM硬盘管理汇总/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/05/Linux LVM硬盘管理汇总/" itemprop="url">
                  Linux LVM硬盘管理汇总
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-05T16:58:23+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一、LVM简介：</p>
<p>LVM ( Logical Volume Manager) 逻辑卷管理的简写，从linux2.4内核上实现。  </p>
<p>LVM讲一个或多个硬盘的分区在逻辑上集合，相当于一个大硬盘来使用。当硬盘空间不够用的时候，可以继续讲其他的硬盘的分区加入其中，这样可以实现磁盘空间的动态管理。</p>
<p>相对于普通的磁盘分区有很大的灵活性</p>
<p>Block Devices：</p>
<p>PE: physical extent ： 大小固定</p>
<p>PV: physical volume</p>
<p>PG: physical group</p>
<p>==========================</p>
<p>LV: logical volume</p>
<p><img src="http://vbird.dic.ksu.edu.tw/linux_basic/0420quota_files/pe_vg.gif" alt="PE 与 VG
的相关性图示"></p>
<p><img src="http://vbird.dic.ksu.edu.tw/linux_basic/0420quota_files/lvm.gif" alt="LVM
各组件的实现流程图示"></p>
<p>存储空间边界：</p>
<p>1. 物理边界</p>
<p>2. 逻辑边界</p>
<p>逻辑卷：</p>
<p>扩展： 物理 –&gt; 逻辑</p>
<p>缩减： 逻辑 –&gt; 物理</p>
<p>缩减不能少于已经存储的所有数据空间的大小</p>
<p>卷组：</p>
<p>快照： snapshot</p>
<p>快照卷 - 就是为原文件提供了一个另外一个访问入口</p>
<p>任何数据改变之前，都会复制一份到快照卷，访问快照之前的没改变的内容，还是去原入口访问。</p>
<p>快照卷没有永远保存的意义，快照卷大小，取决于数据变化大小</p>
<p>LVM：</p>
<p>块设备： 分区，RAID</p>
<p>pv –&gt; vg – lv</p>
<p>pv:</p>
<p>pvcreate, pvs, pvdisplay, pvmove, pvremove, pvscan</p>
<p>vg:</p>
<p>vgcreate, vgs, vgdisplay, vgremove, vgextend, vgreduce, vgscan</p>
<p>lv:</p>
<p>lvcreate, lvs, lvdisplay, lvremove, lvextend, lvreduce, lvscan</p>
<p>例如： 创建10G的vg，</p>
<p>1. 10G PV</p>
<p>2. 3+7G PV</p>
<p>创建逻辑卷：</p>
<p>lvcreate</p>
<p>-n lv_name</p>
<p>-L #UNIT {mMgGtT} 例如： -L 10G</p>
<p>VG_NAME</p>
<p>lv的访问路径：</p>
<p>1. /dev/VG_NAME/LV_NAME</p>
<p>/dev/myvg/mylv</p>
<p>2. /dev/mapper/VG_NAME-LVNAME</p>
<p>/dev/mapper/myvg-mylv</p>
<p>此两者均为符号链接，指向的文件为/dev/dm-#</p>
<p>扩展逻辑卷(在线)：</p>
<p>1. 线确定扩展的目标大小；并确保对应的卷组中有足够的空闲空间可用；</p>
<p>2G–&gt; 4G</p>
<p>lvextend -L 4G /dev/myvg/mylv # -L选项为扩展的目标大小为4G， 实际是扩展了2G</p>
<p>2. 扩展物理边界</p>
<p>lvextend</p>
<p>3. 扩展逻辑边界</p>
<p>resize2fs (此处扩展的是ext系列文件系统，如果是xfs得使用其他命令)</p>
<p>resize2fs /dev/myvg/mylv #此处无须指定vg，因为肯定在当前使用的vg下扩展</p>
<p>缩减很危险！！！</p>
<p>缩减要离线进行</p>
<p>1. 先确定缩减后的目标大小；并确保对应的目标逻辑卷大小中有足够的空间可容纳原有所有数据</p>
<p>2. 先卸载文件系统，并要执行强制检测</p>
<p>e2fsck -f</p>
<p>3. 缩减逻辑边界</p>
<p>resize2fs DEVICE 3G</p>
<p>4. 缩减物理边界</p>
<p>lvreduce</p>
<p>创建快照卷：</p>
<p>lvcreate</p>
<p>-L 目标大小</p>
<p>-n 卷组名称</p>
<p>-s 指定是snapshot类型</p>
<p>-p r 权限只读</p>
<p>参考鸟哥私房菜： <a href="http://vbird.dic.ksu.edu.tw/linux_basic/0420quota_3.php" target="_blank" rel="external">http://vbird.dic.ksu.edu.tw/linux_basic/0420quota_3.php</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/05/29/Linux任务计划详解/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/29/Linux任务计划详解/" itemprop="url">
                  Linux任务计划详解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-05-29T14:24:33+08:00">
                2015-05-29
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux中任务计划分两种：  </p>
<ol>
<li><p>一次性的任务计划： at, batch</p>
</li>
<li><p>周期性的任务计划 : crontab</p>
</li>
</ol>
<p>1. 一次性任务执行：</p>
<p>命令：</p>
<pre><code> at TIME   #回车


at&gt; ls /etc..   #在此命令提示符下 输入要执行的命令或脚本名称
Ctrl+d # 提交任务
</code></pre><p>TIME的格式如下：  </p>
<p>模糊时间：  </p>
<pre><code>now+ # time-unit  例如： now + 3min/hour/days/
noon # 正午12点整
teatime # 下午4点整
midnight #半夜12点整
tomorrow #明天的这个时间点
hh:mm # 00-24:00-59，如果已经过了当前时间，将被排到明天此刻
</code></pre><p>一次性任务队列查看：</p>
<p>at -l 或者 atq  </p>
<p>任务作业执行完成后，结果会通过邮件通知给作业提交者</p>
<p>一次性任务撤销：</p>
<pre><code>at -d # 
atrm #
</code></pre><p>batch: 功能和at相同，但无需指定时间，会自动选择系统资源较空闲时候执行指定的作业</p>
<p>2. 周期性任务执行：</p>
<p>cron: cron daemon, cron的守护进程，一直工作在后台  </p>
<p>守护进程状态查看：  </p>
<pre><code># service crond status
</code></pre><p>如果状态为”is stopped”,则需要执行：  </p>
<pre><code># service crond start
# chkconfig crond on
</code></pre><p>cron任务分两类：  </p>
<p>a. 系统cron： 定义在/etc/crontab  </p>
<p>b. 用户cron： 定义在/var/spool/cron目录， 每一个用户都有一个与用户名同名的文件，功能类似于/etc/crontab  </p>
<p>每行定义一个独立的任务  </p>
<p>/etc/crontab文件格式：</p>
<pre><code>SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
HOME=/
#环境变量
# For details see man 4 crontabs
# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
</code></pre><p>用户cron的每个作业由两部分组成</p>
<p>1.时间</p>
<p>分钟 小时 日 月 周几  </p>
<p>2.命令  </p>
<p>时间表示法：</p>
<p>1. 每个时间位都应该使用其可用的有效取值范围的值</p>
<pre><code>3 * * * * /bin/echo &quot;howdy&quot; #每个小时的第三分钟才会执行一次
7 3 * * * /bin/echo &quot;howdy&quot; #每天的3点7分执行一次， 比hour小的单位上绝对不能有*
7 6 5 * * /bin/echo &quot;howdy&quot; #每个月的5日6:07执行一个
7 6 5 4 * /bin/echo &quot;howdy&quot; #每年的4月5日6:07执行一次
1 9 * * 3 /bin/echo &quot;howdy&quot; #每周3的9:01执行 (月日和周是不同时使用的)
</code></pre><p>2. 某个时间位上的* 表示对应时间为的所有有效取值</p>
<p>3. */# 在对应的时间位的有效取值上每#一次</p>
<pre><code>eg: */3 * * * * #每三分钟一次
0 */3 * * * #每三小时一次
</code></pre><p>4. 某个时间位上的连续区间：</p>
<pre><code>10-50/3 * * * * #每小时的第10-50分钟执行一次
</code></pre><p>5. 离散取值，可使用，分割</p>
<pre><code>1 7,9,13 * * * #每天的7,9,13点1分执行一次
</code></pre><p>丢弃邮件通知：</p>
<p>输出重定向：</p>
<pre><code>&gt; /dev/null #这里只是重定向标准重定向，错误内容还是会发邮件
&amp;&gt; /dev/null 标准和错误重定向， 正确或错误都不会发送邮件
&gt; /dev/null 2&gt;&amp;1 同上
</code></pre><p>用户cron任务的定义方式：</p>
<pre><code>crontab
-l: 列出已经定义的所有任务
-e: 打开编辑界面定义任务， 尽可能不要手动编辑/var/spool/crontab下的文件，-e选项是可以检查语法错误的
-r: 移除所有任务
</code></pre><p>管理员命令</p>
<pre><code>-u USERNAME -e
-u USERNAME -r
-u USERNAME -l
</code></pre><p>注意： 如果在crontab的用户命令中使用% 得转义： 不过，如果使用单引号引起来，也可不不用转义：</p>
<pre><code>5 3 * * * /bin/touch /tmp/testfile-$(date +\%F-\%H-\%M-\%S)
5 3 * * * /bin/touch /tmp/testfile-$(date + &apos;%F-%H-%M-%S&apos;)
</code></pre><p>补充：</p>
<p>实现秒级别的任务：  </p>
<p>每10秒钟：  </p>
<pre><code>* * * * * for i in {1..6};do echo &quot;howdy&quot;; sleep 10; done
</code></pre><p>anacron： cron的补充机制  </p>
<p>检查是否存在上一个有效周期内未曾执行的任务， 如果有， 在开机后的指定时间点执行一次  </p>
<p>注意： 如果定义在crontab文件内的任务是脚本，则脚本中的各命令查找时遵循的是cron文件开头的PATH环境变量</p>
<p>因此在命令行中测试无问题的脚本，在cron中未必</p>
<p>解决方案： a.命令使用绝对路径</p>
<p>b.脚本中定义PATH环境变量  </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/05/25/Linux变量引用及命令替换/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/25/Linux变量引用及命令替换/" itemprop="url">
                  Linux变量引用及命令替换
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-05-25T10:48:02+08:00">
                2015-05-25
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>初学bash编程，其中的{} ()很晕，不知道都是干吗用的。 一写起来就不确定到底该用哪个了，这里记录一下：</p>
<p>变量赋值：</p>
<pre><code>a=&apos;abc&apos;
</code></pre><p>变量引用：</p>
<p>当被引用变量处于长字符串中间，用$ 和{}括起来</p>
<pre><code>echo xx${a}xx
</code></pre><p>命令替换：</p>
<p>两种方式：</p>
<p>一对反引号:  </p>
<pre><code>`date` #此命令则是返回 执行date的结果 为 Sun May 24 19:56:01 PDT 2015
</code></pre><p>一对小括号：</p>
<pre><code>$(date) # 和`date`的效果一样
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Richie Jing" />
          <p class="site-author-name" itemprop="name">Richie Jing</p>
          <p class="site-description motion-element" itemprop="description">Window Server IT pro, love scripting.</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">82</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richie Jing</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  




  
  

  

  

  

  


</body>
</html>
