<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Window Server IT pro, love scripting.">
<meta property="og:type" content="website">
<meta property="og:title" content="Richie's Personal Blog">
<meta property="og:url" content="http://yoursite.com/page/8/index.html">
<meta property="og:site_name" content="Richie's Personal Blog">
<meta property="og:description" content="Window Server IT pro, love scripting.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Richie's Personal Blog">
<meta name="twitter:description" content="Window Server IT pro, love scripting.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/8/"/>





  <title> Richie's Personal Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Richie's Personal Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">Life is short, do something meaningful!</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/08/Remote Desktop License问题不能远程/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/08/Remote Desktop License问题不能远程/" itemprop="url">
                  Remote Desktop License问题不能远程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-08T12:51:49+08:00">
                2014-08-08
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>mstsc /v:IP-OR-HOSTNAME /admin
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/05/powershell try...catch 错误处理及输出日志/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/05/powershell try...catch 错误处理及输出日志/" itemprop="url">
                  powershell try...catch 错误处理及输出日志
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-05T14:45:11+08:00">
                2014-08-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>写脚本必须要能检测和控制错误，所有的语言也都有这个功能，今天简单解析一下powershell的try…catch</p>
<p>首先，powershell 有两个结构</p>
<pre><code>try{}
...
catch{}


try{}
...
catch{}
...
finally{}
</code></pre><p>我们用简单一点的try..catch来说。</p>
<p>在你容易出错的语句上 加上参数 -ErrorAction，这个参数可以允许你控制出错的时候，如何执行，continue, ignore, Inquire,<br>slientlyContinue, stop, suspend</p>
<p>然后再跟一个参数-ErrorVariable , 这个后面必须写 CurrentError</p>
<p>完整的脚本应该是这样：</p>
<pre><code>$conputer=&apos;server&apos;
try
{
    $os=Get-WmiObject -ComputerName $conputer -Class win32_Opearting -ErrorAction    -ErrorVariable CurrentError
}
catch
{
    Write-Host &quot;connection to $conputer is lost!&quot;
}
</code></pre><p>运行后，你也可以输出$CurrentError 来查看具体报出的错误是什么</p>
<p>另外，你可以选择输出你的错误日志(ErrorLog), 在catch部分加入判断脚本来输出log日志，脚本如下：</p>
<pre><code>$conputer=&apos;server&apos;
try
{
    $os=Get-WmiObject -ComputerName $conputer -Class win32_Opearting -ErrorAction    -ErrorVariable CurrentError
}
catch
{
    Write-Host &quot;connection to $conputer is lost!&quot;
    If($ErrorLog)  #这个ErrorLog变量需要在开头的Param()中用语句 [Switch]$ErrorLog开启
    {
        Get-Date | Out-File $LogFile -Force
        $conputer | Out-File $LogFile -Append
        $CurrentError | out-file $LogFile -Append
    }
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/04/Function中参数的用法/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/04/Function中参数的用法/" itemprop="url">
                  Function中参数的用法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-04T16:44:02+08:00">
                2014-08-04
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先，写Function，一定要用get-help 或者help</p>
<p>你可以使用下面这句来获取function_Parameter的用法</p>
<pre><code>get-help about_functions_Advanced_Parameters | clip
#clip帮助你复制到粘贴板，你可以直接粘贴当前内容到任何你想去阅读的地方
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/04/PowerShell的Function标准书写框架格式及实例/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/08/04/PowerShell的Function标准书写框架格式及实例/" itemprop="url">
                  PowerShell的Function标准书写框架格式及实例
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-08-04T14:48:15+08:00">
                2014-08-04
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>&lt;#
 Comment based help
#&gt;
Function Verb-Noun {

    [CmdletBinding()]
    Param(
        [Parameter()][String]$MyString,
        [Parameter()][Int]$MyInt
    )

    Begin{&lt;#Code#&gt;}
    Process{&lt;#Code#&gt;}
    End{&lt;#Code#&gt;}
}
</code></pre><p>定义一个Fuction，动词-名字 是标准的powershell cmelets格式，这个你随便，想起什么名字都可以。但是最好按规范来。好找  </p>
<p>然后是:</p>
<pre><code>[cmeletBinding()]
Param(
    [Parameter()][String]$MyString,
    [Parameter()][int]$MyInt,
    ...
    #如果想接受多个参数，直接更改上面数据类型为对应的数组即可，如下：
    [String[]]$MyStringCollectionList


    #如果你想让特定的参数是必须输入，可以按照下面例句：
    [Parameter(Mandatory=$True)]
    [String]$MyString
    这样，$MyString这个变量就是必须输入的了

    #如果你想让此变量可以接受管道传输的信息，可以这样写：
    [Parameter(ValueFromPipeline=$True)]
    [Parameter(ValueFromPipelineByPropertyName=$=True)]

    #当运行你创建的cmdlets，你想提示用户输入什么，可以这样写：
    #HelpMessage=&apos;Please enter the format like this  2014/08/04&apos;

    #如果想给cmelet使用者多个选择，创建别名，效果是如果这个参数是-Computername
    而你为这个Computername参数创建了一个别名，使用者就可以选择任何一种参数写法来使用
    也就是说，当你定义了一个[Alias](&apos;Hostname&apos;)
    以下任何写法都是合法的：
    Get-NewFunction -Computername   or
    Get-NewFunction -Hostname


    #如果你想固定参数值，可以这样写：
    [ValidateSet(&apos;computer1&apos;,&apos;linux01&apos;)]
    #如果这样写，这个参数就只能接受compuer1和linux01这两个值
    当你输入的值，不在这个ValidateSet中，系统会输出错误，有用的是错误信息中将包含你预设的这两个值
    当你输入的值，可以用Tab自动补齐你设置的值

    #如果你想固定参数个数，可以这样写：
    [ValidateSet(0,2)]
    这样写，就限定了只能输入2个参数值

    #如果你想使用模型（正则表达）来匹配参数值，可以这样写
    [ValidatePattern(&quot;\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b&quot;)]
    以上Pattern可以验证IP地址类型

    #如果要验证一个地址是否存在
    [ValidateScript({test-path $_})]
    这个结果:
        如果测试参数的路径是存在的，返回结果True
        如果测试参数的路径不存在，则返回结果False
)

接下来
#Begin内容一般都是一些vobose内容，执行此Function的时候，只有带上-Vobose才会输出
    Begin{&lt;#Code#&gt;}
#Process,就是执行主代码的位置
    Process{&lt;#Code#&gt;}
    End{&lt;#Code#&gt;}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/29/powershell抓取远程磁盘数据并生成报表（附代码解析）/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/29/powershell抓取远程磁盘数据并生成报表（附代码解析）/" itemprop="url">
                  powershell抓取远程磁盘数据并生成报表（附代码解析）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-29T10:34:13+08:00">
                2014-07-29
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近分派到一个需求，要每天汇总所有服务器的磁盘空间生成报表。</p>
<p>虽然get-PSDrive有转换好的GB，但是当调用 Get-wmiObject | select free, used</p>
<p>数据都是未经处理的，都是很长很长的浮点数据。</p>
<p>所以需要处理一下可以使用 强制转换</p>
<pre><code>[math]::round(3.1415926,2)
#所有的运算符都可以用 Help about_operator 找得到
#写出来就是下面的样子
$servers= get-content -path servers.txt
$object=get-wmiobject win32_logicaldisk -computername $servers|select @{n=&apos;DeviceID&apos;, e={$_.DeviceID}} {% endraw %},
    @{n=&apos;Server&apos;; e={$_.__Server}} {% endraw %},
     @{n=&apos;size(GB)&apos;; e={[math]::round($_.size/1GB,1)}} {% endraw %},
    @{n=&apos;Freespace(GB)&apos;; e={[math]::round($_.freespace/1GB,1)}} {% endraw %},
    @{n=&apos;FreeSpace(TB)&apos;;e={[math]::round($_.Freespace/1TB,2)}} {% endraw %},
    @{n=&apos;%Free&apos;;e={&quot;{0:P0}&quot; -f ($_.freespace/$_.Size)}} {% endraw %}    
</code></pre><p>列举一下 这次脚本以及常用的格式转换：</p>
<pre><code>[math]::round(待转参数,小数点位数)
&quot;{0:P0}&quot; -f $number     #将$number 转换成百分比%

#生成报表部分，将$object转换成html文件,并使用style2.css样式
$object | ConvertTo-Html -CssUri .\style2.css -body &quot;

## Disk Info

&quot; |Out-File .\report.html
</code></pre><p>这样基本功能就实现了.  </p>
<p>但是还有一些细节问题，比如：</p>
<p>如何只选择其中一块或几块硬盘？</p>
<p>如何输出时候按照服务器名字分组？</p>
<p>日后有时间在研究吧，大概满足工作需求。  </p>
<p>而且完全可以不调用WMI， 也可使用powershell内建的Get-PSDrive来搞定</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/23/MCSA到手/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/23/MCSA到手/" itemprop="url">
                  MCSA到手
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-23T14:42:54+08:00">
                2014-07-23
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记得计划考MCSE的日子已经过去1年多了，这一年来，事情太多了，条件根本不允许我有时间来准备考试。</p>
<p>这两个月来，面临换部门培训考试的压力，还要完成原部门总结文档交接的压力。  </p>
<p>能一次不挂的搞定这三科，感觉还不错。</p>
<p>觉得自己大学时候的对于求学时候那份坚持和上进还在。</p>
<p>不过我打算停下脚步，回顾一下，有点累，休息休息。</p>
<p>把重心放到新的工作和生活品质上吧。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/13/70-411过了！/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/13/70-411过了！/" itemprop="url">
                  70-411过了！
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-13T11:27:51+08:00">
                2014-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开心，付出总会有收获，当时觉得很遥远的梦想，可以一步一步来实现。</p>
<p>遗憾，就不要在纠结过去，每天都有一点小小的进步，不日就会积累成可观的高度。</p>
<p>日子慢慢稳定下来了，希望以后每一天都这么安静，美好，有时间去体会这种恬淡生活背后的美好。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/09/Performance Monitor Counters整理/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/09/Performance Monitor Counters整理/" itemprop="url">
                  Performance Monitor Counters整理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-09T15:25:47+08:00">
                2014-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>通常分析windows服务器的性能是一件很麻烦的事情，但是有了performance Monitor就好办了。</p>
<p>从technet上找到这个counters的集合，很清楚明白的知道每一个counter的意义，就知道如何对windows来监控性能，如果是大型网络还可以用来trigger<br>alerts产生工单等等</p>
<p>Performance Monitor Counter总共分四大类：</p>
<ul>
<li><p><strong>Processor Performance Counters.</strong> This section describes the most significant counters associated with the Processor object.</p>
</li>
<li><p><strong>Memory Performance Counters.</strong> This section describes the most significant counters associated with the Memory object.</p>
</li>
<li><p><strong>Disk Performance Counters.</strong> This section describes the most significant counters associated with the PhysicalDisk and LogicalDisk objects.</p>
</li>
<li><p><strong>Network Performance Counters.</strong> This section describes the most significant counters associated with the network interface, network segment, and TCP/IP components.</p>
</li>
</ul>
<p>This section lists all of the objects and counters that were referenced<br>throughout the text, and some extras that will be of particular interest.<br>There are hundreds of Performance Monitor counters that can be used for a<br>multitude of situations. You might consider this the starter list of ones that<br>you should be using on a regular basis. Explanations and usage of the counters<br>is offered where appropriate. Each listing will have the following format:</p>
<p>[Object] : [Counter Name]. [Explanation/Usage]</p>
<p>Recall that an object refers to a Performance Monitor object. For each object<br>there will be multiple counters—[Counter Name]—and potentially multiple<br>instances. This is the case with multiple processor systems or systems with<br>more than one hard drive. Some of the objects and counters are not present<br>unless an NT component or other software is installed on the system. This is<br>specifically stated in the [Explanation/Usage] section of each object/counter<br>pairing.</p>
<h3 id="Processor-Performance-Counters"><a href="#Processor-Performance-Counters" class="headerlink" title="Processor Performance Counters"></a>Processor Performance Counters</h3><p>The Processor object is focused primarily on the CPU of the system. Note that<br>some system have multiple processors, which will display as independent<br>instances for each of these counters.</p>
<p>The counters listed in this section are all used to determine processor<br>performance or influence other components are enforcing over the processor.</p>
<ul>
<li><p><strong>Processor : % Processor Time.</strong> This counter provides a measure of how much time the processor actually spends working on productive threads and how often it was busy servicing requests. This counter actually provides a measurement of how often the system is doing nothing subtracted from 100%. This is a simpler calculation for the processor to make. The processor can never be sitting idle waiting to the next task, unlike our cashier. The CPU must always have something to do. It’s like when you turn on the computer, the CPU is a piece of wire that electric current is always running through, thus it must always be doing something. NT give the CPU something to do when there is nothing else waiting in the queue. This is called the idle thread. The system can easily measure how often the idle thread is running as opposed to having to tally the run time of each of the other process threads. Then , the counter simply subtracts the percentage from 100%.</p>
</li>
<li><p><strong>Processor : Interrupts /sec. </strong>The numbers of interrupts the processor was asked to respond to. Interrupts are generated from hardware components like hard disk controller adapters and network interface cards. A sustained value over 1000 is usually an indication of a problem. Problems would include a poorly configured drivers, errors in drivers, excessive utilization of a device (like a NIC on an IIS server), or hardware failure. Compare this value with the System : Systems Calls/sec. If the Interrupts/sec is much larger over a sustained period, you probably have a hardware issue.</p>
</li>
<li><p><strong>Processor : % Interrupt Time. </strong>This is the percentage of time that the processor is spending on handling Interrupts. Generally, if this value exceeds 50% of the processor time you may have a hardware issue. Some components on the computer can force this issue and not really be a problem. For example a programmable I/O card like an old disk controller card, can take up to 40% of the CPU time. A NIC on a busy IIS server can likewise generate a large percentage of processor activity.</p>
</li>
<li><p><strong>Processor : % User Time. </strong>The value of this counter helps to determine the kind of processing that is affecting the system. Of course the resulting value is the total amount of non-idle time that was spent on User mode operations. This generally means application code.</p>
</li>
<li><p><strong>Processor : %Privilege Time. </strong>This is the amount of time the processor was busy with Kernel mode operations. If the processor is very busy and this mode is high, it is usually an indication of some type of NT service having difficulty, although user mode programs can make calls to the Kernel mode NT components to occasionally cause this type of performance issue.</p>
</li>
<li><p><strong>Processor: %DPC Time. </strong>Much like the other values, this counter shows the amount of time that the processor spends servicing DPC requests. DPC requests are more often than not associated with the network interface.</p>
</li>
<li><p><strong>Process : % Processor Time. </strong>This counter is a natural choice that will give use the amount of time that this particular process spends using the processor resource. There are also % Privilege Time and % User Time counters for this object that will help to identify what the program is spending most of its time doing.</p>
</li>
<li><p><strong>System : Processor Queue Length. </strong>Oddly enough, this processor counter shows up under the System object, but not without good reason. There is only 1 queue for tasks that need to go to the processor, even if there is more than one CPU. Thus, counter provides a measure of the instantaneous size of the queue for all processors at the moment that the measurement was taken. The resulting value is a measure of how many threads are in the Ready state waiting to be processed. When dealing with queues, if the value exceeds 2 for a sustained period, you are definitely having a problem with the resource in question.</p>
</li>
<li><p><strong>System : System Calls/sec. </strong>This counter is a measure of the number of calls made to the system components, Kernel mode services. This is a measure of how busy the system is taking care of applications and services—software stuff. When compared to the Interrupts/Sec it will give you an indication of whether processor issues are hardware or software related. See Processor : Interrupts/Sec for more information.</p>
</li>
<li><p><strong>System : % Total Processor Time.</strong> This counter groups the activity of all the processors together to report the total performance of the entire system. On a single processor machine, this value will equal the %Processor Time value of the processor object.</p>
</li>
<li><p><strong>System : % Total User Time.</strong> This is the total user time of all the processors on the system. See Processor : % User Time for more details.</p>
</li>
<li><p><strong>System : % Total Privledge Time.</strong> This is the total privledge time for all processors on the system collectively. See Processor : % Privledge Time for more details.</p>
</li>
<li><p><strong>System : % Total Interrupt Time. </strong>This is the collective amount of time that all of the processors are spending on handling interrupts. See Processor : % Interrupt Time for more details.</p>
</li>
<li><p><strong>Thread Object : % Processor Time. </strong>This counter takes the analysis to the next level. Typically, this counter would be for programmers, but occasionally there is a more global use for it. For example, if you are trying to examine the actions of a 16-bit process. The 16-bit application will actually be running as a thread in the NTVDM process. If you wish to see the processor usage by the 16-bit without obscuring it with the processing of the NTVDM and WOWEXEC.exe, you will want to examine the individual thread. BackOffice applications tend to have very distinct multiple threads that sometimes are worth examining individually as opposed to in a group. Often the threads of more sophisticated applications can be configured independently from the entire process.</p>
</li>
<li><p><strong>Thread Object : ID Thread. </strong>When a process creates a thread, the system assigns a Thread ID so that it may distinguish the thread among the other threads on the system. Thread IDs are reassigned upon creation and deletion of the threads. You can not expect a thread to have the same ID each time it is created. It is important to use the Thread ID whenever you are looking at any other counters that are specific to the thread. If the thread is deleted, the performance monitor will spike indicating the thread has in fact expired.</p>
</li>
<li><p><strong>Thread Object : Priority Base.</strong> The thread gets a base priority from the Process that created it. The priority of the thread can be adjusted by the system or through a program. This priority is used to judge when the thread is going to have access to the process and how many other threads it may jump ahead of in the processor queue of ready threads.</p>
</li>
<li><p><strong>Process : Process ID.</strong> Each process on Windows NT gets a Process ID that identifies it as a unique process on the system. You can reference the Process ID counter to gain information about the process through API calls. The Process ID is guaranteed to remain unique to the particular process during the entire time that it is running. But, the process is not guaranteed to have the same process ID each time that it is run.</p>
</li>
<li><p><strong>Process : % Processor Time.</strong> Each process will show up as an instance when selecting this counter. This counter will break down how much processor time each process is taking on the CPU. Don’t forget to exclude the Idle and the Total counts when looking at all of the instances.</p>
</li>
<li><p><strong>Process : % User Time.</strong> This will break down the amount of user time that each process is taking out of the total amount of processor time that the processes is using.</p>
</li>
</ul>
<p><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external"></a><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external">Top<br>Of Page</a>  </p>
<h3 id="Memory-Performance-Counters"><a href="#Memory-Performance-Counters" class="headerlink" title="Memory Performance Counters"></a>Memory Performance Counters</h3><p>The following counters all have to do with the management of memory issues. In<br>addition, there will counters that assist in the determination of whether the<br>problem you are having is really a memory issue.</p>
<ul>
<li><p><strong>Memory : Page Faults/sec. </strong>This counter gives a general idea of how many times information being requested is not where the application (and VMM) expects it to be. The information must either be retrieved from another location in memory or from the pagefile. Recall that while a sustained value may indicate trouble here, you should be more concerned with hard page faults that represent actual reads or writes to the disk. Remember that the disk access is much slower than RAM.</p>
</li>
<li><p><strong>Memory : Pages Input/sec. </strong>Use this counter in comparison with the Page Faults/sec counter to determine the percentage of the page faults that are hard page faults.</p>
</li>
</ul>
<p>Thus, Pages Input/sec / Page Faults/sec = % Hard Page Faults. Sustained values<br>surpassing 40% are generally indicative of memory shortages of some kind.<br>While you might know at this point that there is memory shortage of some kind<br>on the system, this is not necessarily an indication that the system is in<br>need of an immediate memory upgrade.</p>
<ul>
<li><p><strong>Memory : Pages Output/sec. </strong>As memory becomes more in demand, you can expect to see that the amount of information being removed from memory is increasing. This may even begin to occur prior to the hard page faults becoming a problem. As memory begins to run short, the system will attempt to first start reducing the applications to their minimum working set. This means moving more information out to the pagefiles and disk. Thus, if your system is on the verge of being truly strained for memory you may begin to see this value climb. Often the first pages to be removed from memory are data pages. The code pages experience more repetitive reuse.</p>
</li>
<li><p><strong>Memory : Pages/sec. </strong>This value is often confused with Page Faults/sec. The Pages/sec counter is a combination of Pages Input/sec and Pages Output/sec counters. Recall that Page Faults/sec is a combination of hard page faults and soft page faults. This counter, however, is a general indicator of how often the system is using the hard drive to store or retrieve memory associated data.</p>
</li>
<li><p><strong>Memory : Page Reads/sec. </strong>This counter is probably the best indicator of a memory shortage because it indicates how often the system is reading from disk because of hard page faults. The system is always using the pagefile even if there is enough RAM to support all of the applications. Thus, some number of page reads will always be encountered. However, a sustained value over 5 Page Reads/sec is often a strong indicator of a memory shortage. You must be careful about viewing these counters to understand what they are telling you. This counter again indicates the number of reads from the disk that were done to satisfy page faults. The amount of pages read each time the system went to the disk may indeed vary. This will be a function of the application and the proximity of the data on the hard drive. Irrelevant of these facts, a sustained value of over 5 is still a strong indicator of a memory problem. Remember the importance of “sustained.” System operations often fluctuate, sometimes widely. So, just because the system has a Page Reads/sec of 24 for a couple of seconds does not mean you have a memory shortage.</p>
</li>
<li><p><strong>Memory : Page Writes/sec.</strong> Much like the Page Reads/sec, this counter indicates how many times the disk was written to in an effort to clear unused items out of memory. Again, the numbers of pages per read may change. Increasing values in this counter often indicate a building tension in the battle for memory resources.</p>
</li>
<li><p><strong>Memory : Available Memory. </strong>This counter indicates the amount of memory that is left after nonpaged pool allocations, paged pool allocations, process’ working sets, and the file system cache have all taken their piece. In general, NT attempts to keep this value around 4 MB. Should it drop below this for a sustained period, on the order of minutes at a time, there may be a memory shortage. Of course, you must always keep an eye out for those times when you are simply attempting to perform memory intensive tasks or large file transfers.</p>
</li>
<li><p><strong>Memory : Nonpageable memory pool bytes. </strong>This counter provides an indication of how NT has divided up the physical memory resource. An uncontrolled increase in this value would be indicative of a memory leak in a Kernel level service or driver.</p>
</li>
<li><p><strong>Memory : Pageable memory pool bytes. </strong>An uncontrolled increase in this counter, with the corresponding decrease in the available memory, would be indicative of a process taking more memory than it should and not giving it back.</p>
</li>
<li><p><strong>Memory : Committed Bytes. </strong>This counter indicates the total amount of memory that has been committed for the exclusive use of any of the services or processes on Windows NT. Should this value approach the committed limit, you will be facing a memory shortage of unknown cause, but of certain severe consequence.</p>
</li>
<li><p><strong>Process : Page Faults/sec. </strong>This is an indication of the number of page faults that occurred due to requests from this particular process. Excessive page faults from a particular process are an indication usually of bad coding practices. Either the functions and DLLs are not organized correctly, or the data set that the application is using is being called in a less than efficient manner.</p>
</li>
<li><p><strong>Process : Pool Paged Bytes. </strong>This is the amount of memory that the process is using in the pageable memory region. This information can be paged out from physical RAM to the pagefile on the hard drive.</p>
</li>
<li><p><strong>Process : Pool NonPaged Bytes. </strong>This is the amount of memory that the process is using that cannot be moved out to the pagefile and thus will remain in physical RAM. Most processes do not use this, however, some real-time applications may find it necessary to keep some DLLs and functions readily available in order to function at the real-time mode.</p>
</li>
<li><p><strong>Process : Working Set. </strong>This is the current size of the memory area that the process is utilizing for code, threads, and data. The size of the working set will grow and shrink as the VMM can permit. When memory is becoming scarce the working sets of the applications will be trimmed. When memory is plentiful the working sets are allowed to grow. Larger working sets mean more code and data in memory making the overall performance of the applications increase. However, a large working set that does not shrink appropriately is usually an indication of a memory leak.</p>
</li>
</ul>
<p><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external"></a><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external">Top<br>Of Page</a>  </p>
<h3 id="Disk-Performance-Counters"><a href="#Disk-Performance-Counters" class="headerlink" title="Disk Performance Counters"></a>Disk Performance Counters</h3><p>The Disk Performance counters help you to evaluate the performance of the disk<br>subsystem. The disk subsystem is more than the disk itself. It will include to<br>disk controller card, the I/O bus of the system, and the disk. When measuring<br>disk performance it is usually better to have a good baseline for performance<br>than simply to try and evaluate the disk performance on a case by case basis.</p>
<p>There are two objects for the disk—PhysicalDisk and LogicalDisk. The counters<br>for the two are identical. However, in some cases they may lead to slightly<br>different conclusions. The PhysicalDisk object is used for the analysis of the<br>overall disk, despite the partitions that may be on the disk. When evaluating<br>overall disk performance this would be the one to select. The LogicalDisk<br>object analyzes information for a single partition. Thus the values will be<br>isolated to activity that is particularly occurring on a single partition and<br>not necessarily representative of the entire load that the disk is burdened<br>with. The LogicalDisk object is useful primarily when looking at the affects<br>or a particular application, like SQL Server, on the disk performance. Again<br>the PhysicalDisk is primarily for looking at the performance of the entire<br>disk subsystem. In the list that follows, the favored object is indicated with<br>the counter. When the LogicalDisk and PhysicalDisk objects are especially<br>different, the counter will be listed twice and the difference specifically<br>mentioned.</p>
<ul>
<li><p><strong>PhysicalDisk : Current Disk Queue Length. </strong>This counter provides a primary measure of disk congestion. Just as the processor queue was an indication of waiting threads, the disk queue is an indication of the number of transactions that are waiting to be processed. Recall that the queue is an important measure for services that operate on a transaction basis. Just like the line at the supermarket, the queue will be representative of not only the number of transactions, but also the length and frequency of each transaction.</p>
</li>
<li><p><strong>PhysicalDisk : % Disk Time. </strong>Much like % Processor time, this counter is a general mark of how busy the disk is. You will see many similarities between the disk and processor since they are both transaction-based services. This counter indicates a disk problem, but must be observed in conjunction with the Current Disk Queue Length counter to be truly informative. Recall also that the disk could be a bottleneck prior to the % Disk Time reaching 100%.</p>
</li>
<li><p><strong>PhysicalDisk : Avg. Disk Queue Length. </strong>This counter is actually strongly related to the %Disk Time counter. This counter converts the %Disk Time to a decimal value and displays it. This counter will be needed in times when the disk configuration employs multiple controllers for multiple physical disks. In these cases, the overall performance of the disk I/O system, which consists of two controllers, could exceed that of an individual disk. Thus, if you were looking at the %Disk Time counter, you would only see a value of 100%, which wouldn’t represent the total potential of the entire system, but only that it had reached the potential of a single disk on a single controller. The real value may be 120% which the Avg. Disk Queue Length counter would display as 1.2.</p>
</li>
<li><p><strong>PhysicalDisk : Disk Reads/sec. </strong>This counter is used to compare to the Memory: Page Inputs/sec counter. You need to compare the two counters to determine how much of the Disk Reads are actually attributed to satisfying page faults.</p>
</li>
<li><p><strong>LogicalDisk : Disk Reads/sec. </strong>When observing an individual application (rather a partition) this counter will be an indication of how often the applications on the partition are reading from the disk. This will provide you with a more exact measure of the contribution of the various processes on the partition that are affecting the disk.</p>
</li>
<li><p><strong>PhysicalDisk : Disk Reads Bytes/sec. </strong>Primarily, you’ll use this counter to describe the performance of disk throughput for the disk subsystem. Remember that you are generally measuring the capability of the entire disk hardware subsystem to respond to requests for information.</p>
</li>
<li><p><strong>LogicalDisk : Disk Reads Bytes/sec. </strong>For the partition, this will be an indication of the rate that data is being transferred. This will be an indication of what type of activity the partition is experiencing. A smaller value will indicate more random reads of smaller sections.</p>
</li>
<li><p><strong>PhysicalDisk : Avg. Disk Bytes/Read. </strong>This counter is used primarily to let you know the average number of bytes transferred per read of the disk system. This helps distinguish between random reads of the disk and the more efficient sequential file reads. A smaller value generally indicates random reads. The value for this counter can also be an indicator of file fragmentation.</p>
</li>
<li><p><strong>PhysicalDisk : Avg. Disk sec/Read. </strong>The value for this counter is generally the number of seconds it takes to do each read. On less-complex disk subsystems involving controllers that do not have intelligent management of the I/O, this value is a multiple of the disk’s rotation per minute. This does not negate the rule that the entire system is being observed. The rotational speed of the hard drive will be the predominant factor in the value with the delays imposed by the controller card and support bus system.</p>
</li>
<li><p><strong>PhysicalDisk: Disk Reads/sec. </strong>The value for this counter is the number of reads that the disk was able to accomplish per second. Changes in this value indicate the amount of random access to the disk. The disk is a mechanical device that is capable of only so much activity. When files are closer together, the disk is permitted to get to the files quicker than if the files are spread throughout the disk. In addition, disk fragmentation can contribute to an increased value here.</p>
</li>
</ul>
<p><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external"></a><a href="http://technet.microsoft.com/en-us/library/cc768048.aspx#mainSection" target="_blank" rel="external">Top<br>Of Page</a>  </p>
<h3 id="Network-Performance-Counters"><a href="#Network-Performance-Counters" class="headerlink" title="Network Performance Counters"></a>Network Performance Counters</h3><p>The network performance counters are not typically installed. The Network<br>Segment object that is referred to here is installed when the Network Monitor<br>Agent is installed. The network interface is installed when the SNMP service<br>is installed. Many of the counters have to do with TCP/IP components, such as<br>the SNMP service which relies on TCP/IP.</p>
<ul>
<li><p><strong>Network Interface : Bytes Sent/sec. </strong>This is how many bytes of data are sent to the NIC. This is a raw measure of throughput for the network interface. We are really measuring the information sent to the interface which is the lowest point we can measure. If you have multiple NIC, you will see multiple instances of this particular counter.</p>
</li>
<li><p><strong>Network Interface: Bytes Received/sec. </strong>This, of course, is how many bytes you get from the NIC. This is a measure of the inbound traffic In measuring the bytes, NT isn’t too particular at this level. So, no matter what the byte is, it is counted. This will include the framing bytes as opposed to just the data.</p>
</li>
<li><p><strong>Network Interface : Bytes Total/sec. </strong>This is simply a combination of the other two counters. This will tell you overall how much information is going in and out of the interface. Typically, you can use this to get a general feel, but will want to look at the Bytes Sent/sec and the Bytes Received/sec for a more exact detail of the type of traffic.</p>
</li>
<li><p><strong>Processor : % DPC Time. </strong>Interrupts can be handled later. These are called Deferred Procedure Calls. You will want to keep track of these as well. The combination of this time with the % Interrupt Time will give you a strong idea of how much of the precious processor time is going to servicing the network.</p>
</li>
<li><p><strong>Processor : DPCs queued/sec. </strong>This will give you the rate at which DPC are being sent to the process queue. Unlike the Processor Queue Length and the Disk Queue Length, this value only shows you the rate at which the DPCs are being added to the queue, no how many are in the queue. Still, observing this value can give you an indication of a growing problem.</p>
</li>
<li><p><strong>Network Segment : %Broadcasts. </strong>This value will let you know how much of the network bandwidth is dedicated to broadcast traffic. Broadcasts are network packets that have been designated as intended for all machines on the segment. Often, it is this type of traffic that has a detrimental affect on the network.</p>
</li>
<li><p><strong>Network Segment : %Multicasts. </strong>This is a measure of the % of the network bandwidth that multicast traffic is taking. Multicast traffic is similar to the broadcast, however, there is a limited number of intended recipients. The idea was that if you can identify multiple recipients you can reduce the repetitive transmission of data. This type of transfer is used most commonly with video conferencing.</p>
</li>
<li><p><strong>TCP : Segments Sent/sec. </strong>This is the rate at which TCP segments are sent. This is how much information that is being sent out for TCP/IP transmissions.</p>
</li>
<li><p><strong>TCP : Segments Received/sec. </strong>Of course, the rate at which segments are received for the protocol.</p>
</li>
<li><p><strong>TCP : Segments/sec. </strong>This is just the total of the previous two counters. This is the information being sent and received. This is a general indication of how busy the TCP/IP traffic is. The segment size is variable and thus, this does not translate easily to bytes.</p>
</li>
<li><p><strong>TCP : Segments Retransmitted/sec. </strong>This is the rate at which retransmissions occur. Retransmissions are measured based on bytes in the data that are recognized as being transmitted before. On a Ethernet/TCP/IP network retransmissions are a fact of life. However, excessive retransmissions indicate a distinct reduction in bandwidth.</p>
</li>
<li><p><strong>TCP : Connection Failures. </strong>This is the raw number of TCP connections that have failed since the server was started. A failure usually indicates a loss of data somewhere in the process. Data lose can occur at many locations. This could be an indication of another device being down, or problems with the client-side configuration of the software.</p>
</li>
<li><p><strong>TCP : Connections Reset. </strong>This is typically a result of a timeout as opposed to an erroneous set of information. The reset results from the a lack of any information over a period of time.</p>
</li>
<li><p><strong>TCP : Connections Established. </strong>This counter represents them number of connections. Unlike the other two this is more and instantaneous counter of how many TCP connections are currently on the system as opposed to a count of the number of successful connections.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/09/GPO enforced和link enabled有什么区别/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/09/GPO enforced和link enabled有什么区别/" itemprop="url">
                  GPO enforced和link enabled有什么区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-09T14:38:39+08:00">
                2014-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>准备考70-411，碰到一个GPO顺序的问题，写下来省得忘了。</p>
<p>GPO enforced 是只能link到当前OU上，不能被后来的GPO覆盖</p>
<p>防止低层的AD containers的GPO setting被block</p>
<p>GPO enabled只是简单应用一些settings到target AD container</p>
<p>没有额外的情况， overriding/blocking是可以的，如果想被block  </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/06/29/70-410过了！/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richie Jing">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richie's Personal Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richie's Personal Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/06/29/70-410过了！/" itemprop="url">
                  70-410过了！
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-06-29T17:30:15+08:00">
                2014-06-29
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>心仪已久的MCSE，终于拿下第一科了！</p>
<p>昨天去考点把70-410拿下，825分</p>
<p>很开心， 不过还有4个考试，毅力真的很重要，记得距离上次准备考试的时间。</p>
<p>已经过去了半年，还是需要坚持。</p>
<p>希望今年可以拿到MCSE</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Richie Jing" />
          <p class="site-author-name" itemprop="name">Richie Jing</p>
          <p class="site-description motion-element" itemprop="description">Window Server IT pro, love scripting.</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">84</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richie Jing</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  




  
  

  

  

  

  


</body>
</html>
